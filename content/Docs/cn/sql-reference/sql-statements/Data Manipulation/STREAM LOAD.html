

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>STREAM LOAD &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="INSERT" href="insert.html" />
    <link rel="prev" title="STOP ROUTINE LOAD" href="STOP ROUTINE LOAD.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installing/index.html">编译与部署</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/index.html">开始使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../administrator-guide/index.html">操作手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending-doris/index.html">扩展功能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../internal/index.html">设计文档</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">SQL 手册</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../sql-functions/index.html">SQL 函数</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">语法帮助</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../Account Management/index.html">用户账户管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Administration/index.html">集群管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Data Definition/index.html">DDL</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">DML</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="BROKER LOAD.html">BROKER LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="CANCEL LOAD.html">CANCEL LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="DELETE.html">DELETE</a></li>
<li class="toctree-l4"><a class="reference internal" href="EXPORT.html">EXPORT</a></li>
<li class="toctree-l4"><a class="reference internal" href="LOAD.html">LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="MINI LOAD.html">MINI LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="MULTI LOAD.html">MULTI LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="PAUSE ROUTINE LOAD.html">PAUSE ROUTINE LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="RESUME ROUTINE LOAD.html">RESUME ROUTINE LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="ROUTINE LOAD.html">ROUTINE LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW ALTER.html">SHOW ALTER</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW BACKUP.html">SHOW BACKUP</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW DATA.html">SHOW DATA</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW DATABASES.html">SHOW DATABASES</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW DELETE.html">SHOW DELETE</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW EXPORT.html">SHOW EXPORT</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW LOAD.html">SHOW LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW PARTITIONS.html">SHOW PARTITIONS</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW PROPERTY.html">SHOW PROPERTY</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW REPOSITORIES.html">SHOW REPOSITORIES</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW RESTORE.html">SHOW RESTORE</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW ROUTINE LOAD.html">SHOW ROUTINE LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW ROUTINE LOAD TASK.html">SHOW ROUTINE LOAD TASK</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW SNAPSHOT.html">SHOW SNAPSHOT</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW TABLES.html">SHOW TABLES</a></li>
<li class="toctree-l4"><a class="reference internal" href="SHOW TABLET.html">SHOW TABLET</a></li>
<li class="toctree-l4"><a class="reference internal" href="STOP ROUTINE LOAD.html">STOP ROUTINE LOAD</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">STREAM LOAD</a></li>
<li class="toctree-l4"><a class="reference internal" href="insert.html">INSERT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Data Types/index.html">数据类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utility/index.html">辅助命令</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../community/index.html">Apache 社区</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">SQL 手册</a> &raquo;</li>
        
          <li><a href="../index.html">语法帮助</a> &raquo;</li>
        
          <li><a href="index.html">DML</a> &raquo;</li>
        
      <li>STREAM LOAD</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../_sources/Docs/cn/sql-reference/sql-statements/Data Manipulation/STREAM LOAD.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stream-load">
<h1>STREAM LOAD<a class="headerlink" href="#stream-load" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NAME:
    stream-load: load data to table in streaming
    
SYNOPSIS
    curl --location-trusted -u user:passwd [-H &quot;&quot;...] -T data.file -XPUT http://fe_host:http_port/api/{db}/{table}/_stream_load

DESCRIPTION
    该语句用于向指定的 table 导入数据，与普通Load区别是，这种导入方式是同步导入。
    这种导入方式仍然能够保证一批导入任务的原子性，要么全部数据导入成功，要么全部失败。
    该操作会同时更新和此 base table 相关的 rollup table 的数据。
    这是一个同步操作，整个数据导入工作完成后返回给用户导入结果。    
    当前支持HTTP chunked与非chunked上传两种方式，对于非chunked方式，必须要有Content-Length来标示上传内容长度，这样能够保证数据的完整性。
    另外，用户最好设置Expect Header字段内容100-continue，这样可以在某些出错场景下避免不必要的数据传输。

OPTIONS
    用户可以通过HTTP的Header部分来传入导入参数
    
    label: 一次导入的标签，相同标签的数据无法多次导入。用户可以通过指定Label的方式来避免一份数据重复导入的问题。
    当前Palo内部保留30分钟内最近成功的label。
    
    column_separator：用于指定导入文件中的列分隔符，默认为\t。如果是不可见字符，则需要加\x作为前缀，使用十六进制来表示分隔符。
    如hive文件的分隔符\x01，需要指定为-H &quot;column_separator:\x01&quot;
    
    columns：用于指定导入文件中的列和 table 中的列的对应关系。如果源文件中的列正好对应表中的内容，那么是不需要指定这个字段的内容的。
    如果源文件与表schema不对应，那么需要这个字段进行一些数据转换。这里有两种形式column，一种是直接对应导入文件中的字段，直接使用字段名表示；
    一种是衍生列，语法为 `column_name` = expression。举几个例子帮助理解。
    例1: 表中有3个列“c1, c2, c3”，源文件中的三个列一次对应的是&quot;c3,c2,c1&quot;; 那么需要指定-H &quot;columns: c3, c2, c1&quot;
    例2: 表中有3个列“c1, c2, c3&quot;, 源文件中前三列依次对应，但是有多余1列；那么需要指定-H &quot;columns: c1, c2, c3, xxx&quot;; 
    最后一个列随意指定个名称占位即可
    例3: 表中有3个列“year, month, day&quot;三个列，源文件中只有一个时间列，为”2018-06-01 01:02:03“格式；
    那么可以指定-H &quot;columns: col, year = year(col), month=month(col), day=day(col)&quot;完成导入
    
    where: 用于抽取部分数据。用户如果有需要将不需要的数据过滤掉，那么可以通过设定这个选项来达到。
    例1: 只导入大于k1列等于20180601的数据，那么可以在导入时候指定-H &quot;where: k1 = 20180601&quot;

    max_filter_ratio：最大容忍可过滤（数据不规范等原因）的数据比例。默认零容忍。数据不规范不包括通过 where 条件过滤掉的行。

    partitions: 用于指定这次导入所设计的partition。如果用户能够确定数据对应的partition，推荐指定该项。不满足这些分区的数据将被过滤掉。
    比如指定导入到p1, p2分区，-H &quot;partitions: p1, p2&quot;

RETURN VALUES
    导入完成后，会以Json格式返回这次导入的相关内容。当前包括一下字段
    Status: 导入最后的状态。
        Success：表示导入成功，数据已经可见；
        Publish Timeout：表述导入作业已经成功Commit，但是由于某种原因并不能立即可见。用户可以视作已经成功不必重试导入
        Label Already Exists: 表明该Label已经被其他作业占用，可能是导入成功，也可能是正在导入。
        用户需要通过get label state命令来确定后续的操作
        其他：此次导入失败，用户可以指定Label重试此次作业
    Message: 导入状态详细的说明。失败时会返回具体的失败原因。
    NumberTotalRows: 从数据流中读取到的总行数
    NumberLoadedRows: 此次导入的数据行数，只有在Success时有效
    NumberFilteredRows: 此次导入过滤掉的行数，即数据质量不合格的行数
    NumberUnselectedRows: 此次导入，通过 where 条件被过滤掉的行数
    LoadBytes: 此次导入的源文件数据量大小
    LoadTimeMs: 此次导入所用的时间
    ErrorURL: 被过滤数据的具体内容，仅保留前1000条
    
ERRORS
    可以通过以下语句查看导入错误详细信息：

    SHOW LOAD WARNINGS ON &#39;url&#39;

    其中 url 为 ErrorURL 给出的 url。
</pre></div>
</div>
</div>
<div class="section" id="example">
<h2>example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. 将本地文件&#39;testData&#39;中的数据导入到数据库&#39;testDb&#39;中&#39;testTbl&#39;的表，使用Label用于去重
    curl --location-trusted -u root -H &quot;label:123&quot; -T testData http://host:port/api/testDb/testTbl/_stream_load
    
2. 将本地文件&#39;testData&#39;中的数据导入到数据库&#39;testDb&#39;中&#39;testTbl&#39;的表，使用Label用于去重, 并且只导入k1等于20180601的数据
    curl --location-trusted -u root -H &quot;label:123&quot; -H &quot;where: k1=20180601&quot; -T testData http://host:port/api/testDb/testTbl/_stream_load

3. 将本地文件&#39;testData&#39;中的数据导入到数据库&#39;testDb&#39;中&#39;testTbl&#39;的表, 允许20%的错误率（用户是defalut_cluster中的）
    curl --location-trusted -u root -H &quot;label:123&quot; -H &quot;max_filter_ratio:0.2&quot; -T testData http://host:port/api/testDb/testTbl/_stream_load
    
4. 将本地文件&#39;testData&#39;中的数据导入到数据库&#39;testDb&#39;中&#39;testTbl&#39;的表, 允许20%的错误率，并且指定文件的列名（用户是defalut_cluster中的）
    curl --location-trusted -u root  -H &quot;label:123&quot; -H &quot;max_filter_ratio:0.2&quot; -H &quot;columns: k2, k1, v1&quot; -T testData http://host:port/api/testDb/testTbl/_stream_load
    
5. 将本地文件&#39;testData&#39;中的数据导入到数据库&#39;testDb&#39;中&#39;testTbl&#39;的表中的p1, p2分区, 允许20%的错误率。
    curl --location-trusted -u root  -H &quot;label:123&quot; -H &quot;max_filter_ratio:0.2&quot; -H &quot;partitions: p1, p2&quot; -T testData http://host:port/api/testDb/testTbl/_stream_load

6. 使用streaming方式导入（用户是defalut_cluster中的）
    seq 1 10 | awk &#39;{OFS=&quot;\t&quot;}{print $1, $1 * 10}&#39; | curl --location-trusted -u root -T - http://host:port/api/testDb/testTbl/_stream_load

7. 导入含有HLL列的表，可以是表中的列或者数据中的列用于生成HLL列
    curl --location-trusted -u root -H &quot;columns: k1, k2, v1=hll_hash(k1)&quot; -T testData http://host:port/api/testDb/testTbl/_stream_load
</pre></div>
</div>
</div>
<div class="section" id="keyword">
<h2>keyword<a class="headerlink" href="#keyword" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">STREAM</span><span class="p">,</span><span class="n">LOAD</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="insert.html" class="btn btn-neutral float-right" title="INSERT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="STOP ROUTINE LOAD.html" class="btn btn-neutral float-left" title="STOP ROUTINE LOAD" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>