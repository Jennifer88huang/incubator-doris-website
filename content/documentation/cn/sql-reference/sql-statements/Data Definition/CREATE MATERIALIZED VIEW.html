

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CREATE MATERIALIZED VIEW &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="CREATE REPOSITORY" href="CREATE REPOSITORY.html" />
    <link rel="prev" title="CREATE INDEX" href="CREATE INDEX.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">中文</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../downloads/index.html">下载</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installing/index.html">编译与部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting-started/index.html">开始使用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../administrator-guide/index.html">操作手册</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../extending-doris/index.html">扩展功能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../internal/index.html">设计文档</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">SQL 手册</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../sql-functions/index.html">SQL 函数</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">语法帮助</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../Account Management/index.html">用户账户管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Administration/index.html">集群管理</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">DDL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Data Manipulation/index.html">DML</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Data Types/index.html">数据类型</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utility/index.html">辅助命令</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer-guide/index.html">开发者手册</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/index.html">Apache 社区</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../en/index.html">English</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">中文</a> &raquo;</li>
        
          <li><a href="../../index.html">SQL 手册</a> &raquo;</li>
        
          <li><a href="../index.html">语法帮助</a> &raquo;</li>
        
          <li><a href="index.html">DDL</a> &raquo;</li>
        
      <li>CREATE MATERIALIZED VIEW</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/cn/sql-reference/sql-statements/Data Definition/CREATE MATERIALIZED VIEW.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
--><div class="section" id="create-materialized-view">
<h1>CREATE MATERIALIZED VIEW<a class="headerlink" href="#create-materialized-view" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>该语句用于创建物化视图。
</pre></div>
</div>
<p>说明:
异步语法，调用成功后仅表示创建物化视图的任务提交成功，用户需要先通过 <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">alter</span> <span class="pre">table</span> <span class="pre">rollup</span></code> 来查看物化视图的创建进度。
在显示 FINISHED 后既可通过 <code class="docutils literal notranslate"><span class="pre">desc</span> <span class="pre">[table_name]</span> <span class="pre">all</span></code> 命令来查看物化视图的 schema 了。</p>
<p>语法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```

CREATE MATERIALIZED VIEW [MV name] as [query]
[PROPERTIES (&quot;key&quot; = &quot;value&quot;)]

```
</pre></div>
</div>
<ol>
<li><p class="first">MV name</p>
<p>物化视图的名称，必填项。</p>
<p>相同表的物化视图名称不可重复。</p>
</li>
<li><p class="first">query</p>
<p>用于构建物化视图的查询语句，查询语句的结果既物化视图的数据。目前支持的 query 格式为:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
SELECT select_expr[, select_expr ...]
FROM [Base view name]
GROUP BY column_name[, column_name ...]
ORDER BY column_name[, column_name ...]

语法和查询语句语法一致。
</pre></div>
</div>
<p>select_expr: 物化视图的 schema 中所有的列。
+ 仅支持不带表达式计算的单列，聚合列。
+ 其中聚合函数目前仅支持 SUM, MIN, MAX 三种，且聚合函数的参数只能是不带表达式计算的单列。
+ 至少包含一个单列。
+ 所有涉及到的列，均只能出现一次。</p>
<p>base view name: 物化视图的原始表名，必填项。
+ 必须是单表，且非子查询</p>
<p>group by: 物化视图的分组列，选填项。
+ 不填则数据不进行分组。</p>
<p>order by: 物化视图的排序列，选填项。
+ 排序列的声明顺序必须和 select_expr 中列声明顺序一致。
+ 如果不声明 order by，则根据规则自动补充排序列。
如果物化视图是聚合类型，则所有的分组列自动补充为排序列。
如果物化视图是非聚合类型，则前 36 个字节自动补充为排序列。如果自动补充的排序个数小于3个，则前三个作为排序列。
+ 如果 query 中包含分组列的话，则排序列必须和分组列一致。</p>
</li>
<li><p class="first">properties</p>
<p>声明物化视图的一些配置，选填项。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
PROPERTIES (&quot;key&quot; = &quot;value&quot;, &quot;key&quot; = &quot;value&quot; ...)
</pre></div>
</div>
<p>以下几个配置，均可声明在此处：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> short_key: 排序列的个数。
 timeout: 物化视图构建的超时时间。
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="example">
<h2>example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Base 表结构为</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">desc</span> <span class="n">duplicate_table</span><span class="p">;</span>
<span class="o">+-------+--------+------+------+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span> <span class="o">|</span> <span class="n">Type</span>   <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>  <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+-------+--------+------+------+---------+-------+</span>
<span class="o">|</span> <span class="n">k1</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">k2</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">k3</span>    <span class="o">|</span> <span class="n">BIGINT</span> <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">k4</span>    <span class="o">|</span> <span class="n">BIGINT</span> <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">+-------+--------+------+------+---------+-------+</span>
</pre></div>
</div>
<ol>
<li><p class="first">创建一个仅包含原始表 （k1, k2）列的物化视图</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create</span> <span class="n">materialized</span> <span class="n">view</span> <span class="n">k1_k2</span> <span class="k">as</span>
    <span class="n">select</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span> <span class="kn">from</span> <span class="nn">duplicate_table</span><span class="p">;</span>
</pre></div>
</div>
<p>物化视图的 schema 如下图，物化视图仅包含两列 k1, k2 且不带任何聚合</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------+-------+--------+------+------+---------+-------+</span>
<span class="o">|</span> <span class="n">IndexName</span>       <span class="o">|</span> <span class="n">Field</span> <span class="o">|</span> <span class="n">Type</span>   <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>  <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+-----------------+-------+--------+------+------+---------+-------+</span>
<span class="o">|</span> <span class="n">k1_k2</span>           <span class="o">|</span> <span class="n">k1</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span> <span class="n">k2</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">+-----------------+-------+--------+------+------+---------+-------+</span>
</pre></div>
</div>
</li>
<li><p class="first">创建一个以 k2 为排序列的物化视图</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create</span> <span class="n">materialized</span> <span class="n">view</span> <span class="n">k2_order</span> <span class="k">as</span>
    <span class="n">select</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k1</span> <span class="kn">from</span> <span class="nn">duplicate_table</span> <span class="n">order</span> <span class="n">by</span> <span class="n">k2</span><span class="p">;</span>
</pre></div>
</div>
<p>物化视图的 schema 如下图，物化视图仅包含两列 k2, k1，其中 k2 列为排序列，不带任何聚合。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">IndexName</span>       <span class="o">|</span> <span class="n">Field</span> <span class="o">|</span> <span class="n">Type</span>   <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">k2_order</span>        <span class="o">|</span> <span class="n">k2</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span> <span class="n">k1</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span> <span class="n">NONE</span>  <span class="o">|</span>
<span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
</pre></div>
</div>
</li>
<li><p class="first">创建一个以 k1, k2 分组，k3 列为 SUM 聚合的物化视图</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create</span> <span class="n">materialized</span> <span class="n">view</span> <span class="n">k1_k2_sumk3</span> <span class="k">as</span>
    <span class="n">select</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k3</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">duplicate_table</span> <span class="n">group</span> <span class="n">by</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">;</span>
</pre></div>
</div>
<p>物化视图的 schema 如下图，物化视图包含两列 k1, k2，sum(k3) 其中 k1, k2 为分组列，sum(k3) 为根据 k1, k2 分组后的 k3 列的求和值。</p>
<p>由于物化视图没有声明排序列，且物化视图带聚合数据，系统默认补充分组列 k1, k2 为排序列。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">IndexName</span>       <span class="o">|</span> <span class="n">Field</span> <span class="o">|</span> <span class="n">Type</span>   <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">k1_k2_sumk3</span>     <span class="o">|</span> <span class="n">k1</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span> <span class="n">k2</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span> <span class="n">k3</span>    <span class="o">|</span> <span class="n">BIGINT</span> <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
</pre></div>
</div>
</li>
<li><p class="first">创建一个去除重复行的物化视图</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create</span> <span class="n">materialized</span> <span class="n">view</span> <span class="n">deduplicate</span> <span class="k">as</span>
    <span class="n">select</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span><span class="p">,</span> <span class="n">k4</span> <span class="kn">from</span> <span class="nn">duplicate_table</span> <span class="n">group</span> <span class="n">by</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span><span class="p">,</span> <span class="n">k4</span><span class="p">;</span>
</pre></div>
</div>
<p>物化视图 schema 如下图，物化视图包含 k1, k2, k3, k4列，且不存在重复行。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">IndexName</span>       <span class="o">|</span> <span class="n">Field</span> <span class="o">|</span> <span class="n">Type</span>   <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">deduplicate</span>     <span class="o">|</span> <span class="n">k1</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span> <span class="n">k2</span>    <span class="o">|</span> <span class="n">INT</span>    <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span> <span class="n">k3</span>    <span class="o">|</span> <span class="n">BIGINT</span> <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                 <span class="o">|</span> <span class="n">k4</span>    <span class="o">|</span> <span class="n">BIGINT</span> <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">+-----------------+-------+--------+------+-------+---------+-------+</span>
</pre></div>
</div>
</li>
<li><p class="first">创建一个不声明排序列的非聚合型物化视图</p>
<p>all_type_table 的 schema 如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+-------+--------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span> <span class="o">|</span> <span class="n">Type</span>         <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+-------+--------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">k1</span>    <span class="o">|</span> <span class="n">TINYINT</span>      <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">k2</span>    <span class="o">|</span> <span class="n">SMALLINT</span>     <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">k3</span>    <span class="o">|</span> <span class="n">INT</span>          <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">k4</span>    <span class="o">|</span> <span class="n">BIGINT</span>       <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">k5</span>    <span class="o">|</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">k6</span>    <span class="o">|</span> <span class="n">DOUBLE</span>       <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span> <span class="n">NONE</span>  <span class="o">|</span>
<span class="o">|</span> <span class="n">k7</span>    <span class="o">|</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span> <span class="n">NONE</span>  <span class="o">|</span>
<span class="o">+-------+--------------+------+-------+---------+-------+</span>
</pre></div>
</div>
<p>物化视图包含 k3, k4, k5, k6, k7 列，且不声明排序列，则创建语句如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create</span> <span class="n">materialized</span> <span class="n">view</span> <span class="n">mv_1</span> <span class="k">as</span>
    <span class="n">select</span> <span class="n">k3</span><span class="p">,</span> <span class="n">k4</span><span class="p">,</span> <span class="n">k5</span><span class="p">,</span> <span class="n">k6</span><span class="p">,</span> <span class="n">k7</span> <span class="kn">from</span> <span class="nn">all_type_table</span><span class="p">;</span>
</pre></div>
</div>
<p>系统默认补充的排序列为 k3, k4, k5 三列。这三列类型的字节数之和为 4(INT) + 8(BIGINT) + 16(DECIMAL) = 28 &lt; 36。所以补充的是这三列作为排序列。
物化视图的 schema 如下，可以看到其中 k3, k4, k5 列的 key 字段为 true，也就是排序列。k6, k7 列的 key 字段为 false，也就是非排序列。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------------+-------+--------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">IndexName</span>      <span class="o">|</span> <span class="n">Field</span> <span class="o">|</span> <span class="n">Type</span>         <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+----------------+-------+--------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">mv_1</span>           <span class="o">|</span> <span class="n">k3</span>    <span class="o">|</span> <span class="n">INT</span>          <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                <span class="o">|</span> <span class="n">k4</span>    <span class="o">|</span> <span class="n">BIGINT</span>       <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                <span class="o">|</span> <span class="n">k5</span>    <span class="o">|</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>                <span class="o">|</span> <span class="n">k6</span>    <span class="o">|</span> <span class="n">DOUBLE</span>       <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span> <span class="n">NONE</span>  <span class="o">|</span>
<span class="o">|</span>                <span class="o">|</span> <span class="n">k7</span>    <span class="o">|</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">Yes</span>  <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span> <span class="n">NONE</span>  <span class="o">|</span>
<span class="o">+----------------+-------+--------------+------+-------+---------+-------+</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="keyword">
<h2>keyword<a class="headerlink" href="#keyword" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span><span class="p">,</span> <span class="n">MATERIALIZED</span><span class="p">,</span> <span class="n">VIEW</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="CREATE REPOSITORY.html" class="btn btn-neutral float-right" title="CREATE REPOSITORY" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="CREATE INDEX.html" class="btn btn-neutral float-left" title="CREATE INDEX" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>