

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SQL MODE &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="时区" href="time-zone.html" />
    <link rel="prev" title="文件管理器" href="small-file-mgr.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">中文</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installing/index.html">编译与部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/index.html">开始使用</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">操作手册</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="load-data/index.html">数据导入</a></li>
<li class="toctree-l3"><a class="reference internal" href="alter-table/index.html">表结构变更</a></li>
<li class="toctree-l3"><a class="reference internal" href="http-actions/index.html">HTTP API</a></li>
<li class="toctree-l3"><a class="reference internal" href="operation/index.html">运维操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="config/index.html">配置文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="backup-restore.html">备份与恢复</a></li>
<li class="toctree-l3"><a class="reference internal" href="broker.html">Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="colocation-join.html">Colocation Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="export-manual.html">数据导出</a></li>
<li class="toctree-l3"><a class="reference internal" href="privilege.html">权限管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="small-file-mgr.html">文件管理器</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">SQL MODE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">sql mode 介绍</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">原理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">操作方式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mode">已支持mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">复合mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="time-zone.html">时区</a></li>
<li class="toctree-l3"><a class="reference internal" href="variables.html">变量</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extending-doris/index.html">扩展功能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/index.html">设计文档</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sql-reference/index.html">SQL 手册</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer-guide/index.html">开发者手册</a></li>
<li class="toctree-l2"><a class="reference internal" href="../community/index.html">Apache 社区</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../en/index.html">English</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">中文</a> &raquo;</li>
        
          <li><a href="index.html">操作手册</a> &raquo;</li>
        
      <li>SQL MODE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/cn/administrator-guide/sql-mode.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
--><div class="section" id="sql-mode">
<h1>SQL MODE<a class="headerlink" href="#sql-mode" title="Permalink to this headline">¶</a></h1>
<p>Doris新支持的sql mode参照了 Mysql 的sql mode管理机制，每个客户端都能设置自己的sql mode，拥有Admin权限的数据库管理员可以设置全局sql mode。</p>
<div class="section" id="id1">
<h2>sql mode 介绍<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>sql mode使用户能在不同风格的sql语法和数据校验严格度间做切换，使Doris对其他数据库有更好的兼容性。例如在一些数据库里，’||’符号是一个字符串连接符，但在Doris里却是与’or’等价的，这时用户只需要使用sql mode切换到自己想要的风格。每个客户端都能设置sql mode，并在当前对话中有效，只有拥有Admin权限的用户可以设置全局sql mode。</p>
</div>
<div class="section" id="id2">
<h2>原理<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>sql mode用一个64位的Long型存储在SessionVariables中，这个地址的每一位都代表一个mode的开启/禁用(1表示开启，0表示禁用)状态，只要知道每一种mode具体是在哪一位，我们就可以通过位运算方便快速的对sql mode进行校验和操作。</p>
<p>每一次对sql mode的查询，都会对此Long型进行一次解析，变成用户可读的字符串形式，同理，用户发送给服务器的sql mode字符串，会被解析成能够存储在SessionVariables中的Long型。</p>
<p>已被设置好的全局sql mode会被持久化，因此对全局sql mode的操作总是只需一次，即使程序重启后仍可以恢复上一次的全局sql mode。</p>
</div>
<div class="section" id="id3">
<h2>操作方式<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>1、设置sql mode</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="k">global</span> <span class="n">sql_mode</span> <span class="o">=</span> <span class="s2">&quot;DEFAULT&quot;</span>
<span class="nb">set</span> <span class="n">session</span> <span class="n">sql_mode</span> <span class="o">=</span> <span class="s2">&quot;DEFAULT&quot;</span>
</pre></div>
</div>
<blockquote>
<div>目前Doris的默认sql mode是DEFAULT（但马上会在后续修改中会改变）。
设置global sql mode需要Admin权限，并会影响所有在此后连接的客户端。
设置session sql mode只会影响当前对话客户端，默认为session方式。</div></blockquote>
<p>2、查询sql mode</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">@</span><span class="nd">@global</span><span class="o">.</span><span class="n">sql_mode</span>
<span class="n">select</span> <span class="o">@</span><span class="nd">@session</span><span class="o">.</span><span class="n">sql_mode</span>
</pre></div>
</div>
<blockquote>
<div>除了这种方式，你还可以通过下面方式返回所有session variables来查看当前sql mode</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">show</span> <span class="k">global</span> <span class="n">variables</span>
<span class="n">show</span> <span class="n">session</span> <span class="n">variables</span>
</pre></div>
</div>
</div>
<div class="section" id="mode">
<h2>已支持mode<a class="headerlink" href="#mode" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">PIPES_AS_CONCAT</span></code></p>
<p>在此模式下，’||’符号是一种字符串连接符号（同CONCAT()函数），而不是’OR’符号的同义词。(e.g., <code class="docutils literal notranslate"><span class="pre">'a'||'b'</span> <span class="pre">=</span> <span class="pre">'ab'</span></code>, <code class="docutils literal notranslate"><span class="pre">1||0</span> <span class="pre">=</span> <span class="pre">'10'</span></code>)</p>
</li>
</ol>
</div>
<div class="section" id="id4">
<h2>复合mode<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>（后续补充）</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="time-zone.html" class="btn btn-neutral float-right" title="时区" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="small-file-mgr.html" class="btn btn-neutral float-left" title="文件管理器" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>