

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced Use Guide &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Best Practices" href="best-practice_EN.html" />
    <link rel="prev" title="Guidelines for Basic Use" href="basic-usage_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installing/index.html">Compilation and deployment</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Getting started</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="basic-usage_EN.html">Guidelines for Basic Use</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Advanced Use Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#table-1-structural-change">Table 1 Structural Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rollup">2 Rollup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#query-of-data-table">2 Query of Data Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="best-practice_EN.html">Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-partition_EN.html">Data Partition</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-model-rollup_EN.html">Data Model, ROLLUP and Prefix Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="hit-the-rollup_EN.html">Rollup and query</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../administrator-guide/index.html">Administrator Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/index.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sql-reference/index.html">SQL Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">English</a> &raquo;</li>
        
          <li><a href="index.html">Getting started</a> &raquo;</li>
        
      <li>Advanced Use Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/getting-started/advance-usage_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
--><div class="section" id="advanced-use-guide">
<h1>Advanced Use Guide<a class="headerlink" href="#advanced-use-guide" title="Permalink to this headline">¶</a></h1>
<p>Here we introduce some of Doris’s advanced features.</p>
<div class="section" id="table-1-structural-change">
<h2>Table 1 Structural Change<a class="headerlink" href="#table-1-structural-change" title="Permalink to this headline">¶</a></h2>
<p>Schema of the table can be modified using the ALTER TABLE command, including the following modifications:</p>
<ul class="simple">
<li>Additional columns</li>
<li>Delete columns</li>
<li>Modify column type</li>
<li>Changing column order</li>
</ul>
<p>Examples are given below.</p>
<p>Schema of Table 1 is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+-------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span>    <span class="o">|</span> <span class="n">Type</span>        <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+----------+-------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">siteid</span>   <span class="o">|</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>     <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="mi">10</span>      <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">citycode</span> <span class="o">|</span> <span class="n">smallint</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span>         <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">pv</span>       <span class="o">|</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">+----------+-------------+------+-------+---------+-------+</span>
</pre></div>
</div>
<p>We added a new column of uv, type BIGINT, aggregation type SUM, default value is 0:</p>
<p><code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">table1</span> <span class="pre">ADD</span> <span class="pre">COLUMN</span> <span class="pre">uv</span> <span class="pre">BIGINT</span> <span class="pre">SUM</span> <span class="pre">DEFAULT</span> <span class="pre">'0'</span> <span class="pre">after</span> <span class="pre">pv;</span></code></p>
<p>After successful submission, you can view the progress of the job by following commands:</p>
<p><code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">COLUMN;</span></code></p>
<p>When the job state is FINISHED, the job is completed. The new Schema is in force.</p>
<p>After ALTER TABLE is completed, you can view the latest Schema through <code class="docutils literal notranslate"><span class="pre">DESC</span> <span class="pre">TABLE</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">DESC</span> <span class="n">table1</span><span class="p">;</span>
<span class="o">+----------+-------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span>    <span class="o">|</span> <span class="n">Type</span>        <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+----------+-------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">siteid</span>   <span class="o">|</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>     <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="mi">10</span>      <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">citycode</span> <span class="o">|</span> <span class="n">smallint</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span>         <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">pv</span>       <span class="o">|</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">uv</span>       <span class="o">|</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">+----------+-------------+------+-------+---------+-------+</span>
<span class="mi">5</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>The following command can be used to cancel the job currently being executed:</p>
<p><code class="docutils literal notranslate"><span class="pre">CANCEL</span> <span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">COLUMN</span> <span class="pre">FROM</span> <span class="pre">table1</span></code></p>
<p>For more help, see `HELP ALTER TABLE’.</p>
</div>
<div class="section" id="rollup">
<h2>2 Rollup<a class="headerlink" href="#rollup" title="Permalink to this headline">¶</a></h2>
<p>Rollup can be understood as a physical index structure of Table. ** Physicalization ** is because its data is physically stored independently, and ** indexing ** means that Rollup can adjust column order to increase the hit rate of prefix index, or reduce key column to increase data aggregation.</p>
<p>Examples are given below.</p>
<p>Schema of Table 1 is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+----------+-------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span>    <span class="o">|</span> <span class="n">Type</span>        <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+----------+-------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">siteid</span>   <span class="o">|</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>     <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="mi">10</span>      <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">citycode</span> <span class="o">|</span> <span class="n">smallint</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span>         <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">pv</span>       <span class="o">|</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">uv</span>       <span class="o">|</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">+----------+-------------+------+-------+---------+-------+</span>
</pre></div>
</div>
<p>For table1 detailed data, siteid, citycode and username form a set of keys, which aggregate the PV field. If the business side often has the need to see the total amount of PV in the city, it can build a rollup with only citycode and pv.</p>
<p><code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">table1</span> <span class="pre">ADD</span> <span class="pre">ROLLUP</span> <span class="pre">rollup_city(citycode,</span> <span class="pre">pv);</span></code></p>
<p>After successful submission, you can view the progress of the job by following commands:</p>
<p><code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">ROLLUP;</span></code></p>
<p>When the job state is FINISHED, the job is completed.</p>
<p>When Rollup is established, you can use `DESC table1 ALL’to view the Rollup information of the table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">desc</span> <span class="n">table1</span> <span class="nb">all</span><span class="p">;</span>
<span class="o">+-------------+----------+-------------+------+-------+--------+-------+</span>
<span class="o">|</span> <span class="n">IndexName</span>   <span class="o">|</span> <span class="n">Field</span>    <span class="o">|</span> <span class="n">Type</span>        <span class="o">|</span> <span class="n">Null</span> <span class="o">|</span> <span class="n">Key</span>   <span class="o">|</span> <span class="n">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+-------------+----------+-------------+------+-------+---------+-------+</span>
<span class="o">|</span> <span class="n">table1</span>      <span class="o">|</span> <span class="n">siteid</span>   <span class="o">|</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>     <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="mi">10</span>      <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span> <span class="n">citycode</span> <span class="o">|</span> <span class="n">smallint</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span>         <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span> <span class="n">pv</span>       <span class="o">|</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span> <span class="n">uv</span>       <span class="o">|</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span>          <span class="o">|</span>             <span class="o">|</span>      <span class="o">|</span>       <span class="o">|</span>         <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">rollup_city</span> <span class="o">|</span> <span class="n">citycode</span> <span class="o">|</span> <span class="n">smallint</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">true</span>  <span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>             <span class="o">|</span> <span class="n">pv</span>       <span class="o">|</span> <span class="n">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="o">|</span> <span class="n">No</span>   <span class="o">|</span> <span class="n">false</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="n">SUM</span>   <span class="o">|</span>
<span class="o">+-------------+----------+-------------+------+-------+---------+-------+</span>
<span class="mi">8</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mf">0.01</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>The following command can be used to cancel the job currently being executed:</p>
<p><code class="docutils literal notranslate"><span class="pre">CANCEL</span> <span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">ROLLUP</span> <span class="pre">FROM</span> <span class="pre">table1;</span></code></p>
<p>After Rollup is established, the query does not need to specify Rollup to query. Or specify the original table for query. The program automatically determines whether Rollup should be used. Whether Rollup is hit or not can be viewed by the `EXPLAIN your_sql;’command.</p>
<p>For more help, see <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">ALTER</span> <span class="pre">TABLE</span></code>.</p>
</div>
<div class="section" id="query-of-data-table">
<h2>2 Query of Data Table<a class="headerlink" href="#query-of-data-table" title="Permalink to this headline">¶</a></h2>
<div class="section" id="memory-limitation">
<h3>2.1 Memory Limitation<a class="headerlink" href="#memory-limitation" title="Permalink to this headline">¶</a></h3>
<p>To prevent a user’s query from consuming too much memory. Queries are controlled in memory. A query task uses no more than 2GB of memory by default on a single BE node.</p>
<p>When users use it, if they find a <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">limit</span> <span class="pre">exceeded</span></code> error, they usually exceed the memory limit.</p>
<p>Users should try to optimize their SQL statements when they encounter memory overrun.</p>
<p>If it is found that 2GB memory cannot be satisfied, the memory parameters can be set manually.</p>
<p>Display query memory limits:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SHOW</span> <span class="n">VARIABLES</span> <span class="n">LIKE</span> <span class="s2">&quot;%mem_limit%&quot;</span><span class="p">;</span>
<span class="o">+---------------+------------+</span>
<span class="o">|</span> <span class="n">Variable_name</span> <span class="o">|</span> <span class="n">Value</span>      <span class="o">|</span>
<span class="o">+---------------+------------+</span>
<span class="o">|</span> <span class="n">exec_mem_limit</span><span class="o">|</span> <span class="mi">2147483648</span> <span class="o">|</span>
<span class="o">+---------------+------------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>The unit of <code class="docutils literal notranslate"><span class="pre">exec_mem_limit</span></code> is byte, and the value of <code class="docutils literal notranslate"><span class="pre">exec_mem_limit</span></code> can be changed by the <code class="docutils literal notranslate"><span class="pre">SET</span></code> command. If changed to 8GB.</p>
<p><code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">exec_mem_limit</span> <span class="pre">=</span> <span class="pre">8589934592;</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SHOW</span> <span class="n">VARIABLES</span> <span class="n">LIKE</span> <span class="s2">&quot;%mem_limit%&quot;</span><span class="p">;</span>
<span class="o">+---------------+------------+</span>
<span class="o">|</span> <span class="n">Variable_name</span> <span class="o">|</span> <span class="n">Value</span>      <span class="o">|</span>
<span class="o">+---------------+------------+</span>
<span class="o">|</span> <span class="n">exec_mem_limit</span><span class="o">|</span> <span class="mi">8589934592</span> <span class="o">|</span>
<span class="o">+---------------+------------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li>The above modification is session level and is only valid within the current connection session. Disconnecting and reconnecting will change back to the default value.</li>
<li>If you need to modify the global variable, you can set it as follows: <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">GLOBAL</span> <span class="pre">exec_mem_limit</span> <span class="pre">=</span> <span class="pre">8589934592;</span></code> When the setup is complete, disconnect the session and log in again, and the parameters will take effect permanently.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="query-timeout">
<h3>2.2 Query timeout<a class="headerlink" href="#query-timeout" title="Permalink to this headline">¶</a></h3>
<p>The current default query time is set to 300 seconds. If a query is not completed within 300 seconds, the query will be cancelled by the Doris system. Users can use this parameter to customize the timeout time of their applications and achieve a blocking mode similar to wait (timeout).</p>
<p>View the current timeout settings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SHOW</span> <span class="n">VARIABLES</span> <span class="n">LIKE</span> <span class="s2">&quot;%query_timeout%&quot;</span><span class="p">;</span>
<span class="o">+---------------+-------+</span>
<span class="o">|</span> <span class="n">Variable_name</span> <span class="o">|</span> <span class="n">Value</span> <span class="o">|</span>
<span class="o">+---------------+-------+</span>
<span class="o">|</span> <span class="n">QUERY_TIMEOUT</span> <span class="o">|</span> <span class="mi">300</span>   <span class="o">|</span>
<span class="o">+---------------+-------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>Modify the timeout to 1 minute:</p>
<p><code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">query</span> <span class="pre">timeout</span> <span class="pre">=60;</span></code></p>
<blockquote>
<div><ul class="simple">
<li>The current timeout check interval is 5 seconds, so timeouts less than 5 seconds are not very accurate.</li>
<li>The above modifications are also session level. Global validity can be modified by <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">GLOBAL</span></code>.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="broadcast-shuffle-join">
<h3>2.3 Broadcast/Shuffle Join<a class="headerlink" href="#broadcast-shuffle-join" title="Permalink to this headline">¶</a></h3>
<p>By default, the system implements Join by conditionally filtering small tables, broadcasting them to the nodes where the large tables are located, forming a memory Hash table, and then streaming out the data of the large tables Hash Join. However, if the amount of data filtered by small tables can not be put into memory, Join will not be able to complete at this time. The usual error should be caused by memory overrun first.</p>
<p>If you encounter the above situation, it is recommended to use Shuffle Join, also known as Partitioned Join. That is, small and large tables are Hash according to Join’s key, and then distributed Join. This memory consumption is allocated to all computing nodes in the cluster.</p>
<p>Use Broadcast Join (default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mysql&gt; select sum(table1.pv) from table1 join table2 where table1.siteid = 2;
+--------------------+
| sum(`table1`.`pv`) |
+--------------------+
|                 10 |
+--------------------+
1 row in set (0.20 sec)
</pre></div>
</div>
<p>Use Broadcast Join (explicitly specified):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mysql&gt; select sum(table1.pv) from table1 join [broadcast] table2 where table1.siteid = 2;
+--------------------+
| sum(`table1`.`pv`) |
+--------------------+
|                 10 |
+--------------------+
1 row in set (0.20 sec)
</pre></div>
</div>
<p>Shuffle Join:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mysql&gt; select sum(table1.pv) from table1 join [shuffle] table2 where table1.siteid = 2;
+--------------------+
| sum(`table1`.`pv`) |
+--------------------+
|                 10 |
+--------------------+
1 row in set (0.15 sec)
</pre></div>
</div>
</div>
<div class="section" id="query-retry-and-high-availability">
<h3>2.4 Query Retry and High Availability<a class="headerlink" href="#query-retry-and-high-availability" title="Permalink to this headline">¶</a></h3>
<p>When multiple FE nodes are deployed, users can deploy load balancing layers on top of multiple FEs to achieve high availability of Doris.</p>
<p>Here are some highly available solutions:</p>
<p><strong>The first</strong></p>
<p>I retry and load balancing in application layer code. For example, if a connection is found to be dead, it will automatically retry on other connections. Application-level code retry requires the application to configure multiple Doris front-end node addresses.</p>
<p><strong>Second</strong></p>
<p>If you use MySQL JDBC connector to connect Doris, you can use jdbc’s automatic retry mechanism:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jdbc:mysql:/[host:port],[host:port].../[database][? propertyName1][=propertyValue1][&amp;propertyName2][=propertyValue2]...
</pre></div>
</div>
<p><strong>The third</strong></p>
<p>Applications can connect to and deploy MySQL Proxy on the same machine by configuring MySQL Proxy’s Failover and Load Balance functions.</p>
<p><code class="docutils literal notranslate"><span class="pre">http://dev.mysql.com/doc/refman/5.6/en/mysql-proxy-using.html</span></code></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="best-practice_EN.html" class="btn btn-neutral float-right" title="Best Practices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basic-usage_EN.html" class="btn btn-neutral float-left" title="Guidelines for Basic Use" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>