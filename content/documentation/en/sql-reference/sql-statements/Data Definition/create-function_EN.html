

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CREATE FUNCTION &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="DROP FUNCTION" href="drop-function_EN.html" />
    <link rel="prev" title="TRUNCATE TABLES" href="TRUNCATE TABLE_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../installing/index.html">Compilation and deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting-started/index.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../administrator-guide/index.html">Administrator Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../internal/index.html">Design Documents</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">SQL Manual</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../sql-functions/index.html">SQL Functions</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">DDL Statements</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../Account Management/index.html">Account Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Administration/index.html">Administration</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Data Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Data Manipulation/index.html">Data Manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Data Types/index.html">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utility/index.html">Utility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">English</a> &raquo;</li>
        
          <li><a href="../../index.html">SQL Manual</a> &raquo;</li>
        
          <li><a href="../index.html">DDL Statements</a> &raquo;</li>
        
          <li><a href="index.html">Data Definition</a> &raquo;</li>
        
      <li>CREATE FUNCTION</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/sql-reference/sql-statements/Data Definition/create-function_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
--><div class="section" id="create-function">
<h1>CREATE FUNCTION<a class="headerlink" href="#create-function" title="Permalink to this headline">¶</a></h1>
<p>##Description</p>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="p">[</span><span class="n">AGGREGATE</span><span class="p">]</span> <span class="n">FUNCTION</span> <span class="n">function_name</span>
	<span class="p">(</span><span class="n">angry</span> <span class="nb">type</span> <span class="p">[</span><span class="o">...</span><span class="p">])</span>
	<span class="n">RETURNS</span> <span class="n">ret_type</span>
	<span class="p">[</span><span class="n">INTERMEDIATE</span> <span class="n">inter_type</span><span class="p">]</span>
	<span class="p">[</span><span class="n">PROPERTIES</span> <span class="p">(</span><span class="s2">&quot;key&quot;</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span> <span class="p">[,</span> <span class="o">...</span><span class="p">])</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">AGGREGATE</span></code>: If this is the case, it means that the created function is an aggregate function, otherwise it is a scalar function.</p>
<p><code class="docutils literal notranslate"><span class="pre">Function_name</span></code>: To create the name of the function, you can include the name of the database. For example: `db1.my_func’.</p>
<p><code class="docutils literal notranslate"><span class="pre">arg_type':</span> <span class="pre">The</span> <span class="pre">parameter</span> <span class="pre">type</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">function</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">same</span> <span class="pre">as</span> <span class="pre">the</span> <span class="pre">type</span> <span class="pre">defined</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">time</span> <span class="pre">of</span> <span class="pre">table</span> <span class="pre">building.</span> <span class="pre">Variable-length</span> <span class="pre">parameters</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">represented</span> <span class="pre">by</span></code>,…`. If it is a variable-length type, the type of the variable-length part of the parameters is the same as the last non-variable-length parameter type.</p>
<p><code class="docutils literal notranslate"><span class="pre">ret_type</span></code>: Function return type.</p>
<p><code class="docutils literal notranslate"><span class="pre">Inter_type</span></code>: A data type used to represent the intermediate stage of an aggregate function.</p>
<p><code class="docutils literal notranslate"><span class="pre">properties</span></code>: Used to set properties related to this function. Properties that can be set include</p>
<p>“Object_file”: Custom function dynamic library URL path, currently only supports HTTP/HTTPS protocol, this path needs to remain valid throughout the life cycle of the function. This option is mandatory</p>
<p>“symbol”: Function signature of scalar functions for finding function entries from dynamic libraries. This option is mandatory for scalar functions</p>
<p>“init_fn”: Initialization function signature of aggregate function. Necessary for aggregation functions</p>
<p>“update_fn”: Update function signature of aggregate function. Necessary for aggregation functions</p>
<p>“merge_fn”: Merge function signature of aggregate function. Necessary for aggregation functions</p>
<p>“serialize_fn”: Serialized function signature of aggregate function. For aggregation functions, it is optional, and if not specified, the default serialization function will be used</p>
<p>“finalize_fn”: A function signature that aggregates functions to obtain the final result. For aggregation functions, it is optional. If not specified, the default fetch result function will be used.</p>
<p>“md5”: The MD5 value of the function dynamic link library, which is used to verify that the downloaded content is correct. This option is optional</p>
<p>“prepare_fn”: Function signature of the prepare function for finding the entry from the dynamic library. This option is optional for custom functions</p>
<p>“close_fn”: Function signature of the close function for finding the entry from the dynamic library. This option is optional for custom functions</p>
</div></blockquote>
<p>This statement creates a custom function. Executing this command requires that the user have <code class="docutils literal notranslate"><span class="pre">ADMIN</span></code> privileges.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">function_name</span></code> contains the database name, the custom function will be created in the corresponding database, otherwise the function will be created in the database where the current session is located. The name and parameters of the new function cannot be the same as functions already existing in the current namespace, otherwise the creation will fail. But only with the same name and different parameters can the creation be successful.</p>
</div>
<div class="section" id="example">
<h2>example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p class="first">Create a custom scalar function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">my_add</span><span class="p">(</span><span class="n">INT</span><span class="p">,</span> <span class="n">INT</span><span class="p">)</span> <span class="n">RETURNS</span> <span class="n">INT</span> <span class="n">PROPERTIES</span> <span class="p">(</span>
	<span class="s2">&quot;symbol&quot;</span> <span class="o">=</span> <span class="s2">&quot;_ZN9doris_udf6AddUdfEPNS_15FunctionContextERKNS_6IntValES4_&quot;</span><span class="p">,</span>
	<span class="s2">&quot;object_file&quot;</span> <span class="o">=</span><span class="s2">&quot;http://host:port/libmyadd.so&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a custom scalar function with prepare/close functions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">my_add</span><span class="p">(</span><span class="n">INT</span><span class="p">,</span> <span class="n">INT</span><span class="p">)</span> <span class="n">RETURNS</span> <span class="n">INT</span> <span class="n">PROPERTIES</span> <span class="p">(</span>
	<span class="s2">&quot;symbol&quot;</span> <span class="o">=</span> 	<span class="s2">&quot;_ZN9doris_udf6AddUdfEPNS_15FunctionContextERKNS_6IntValES4_&quot;</span><span class="p">,</span>
	<span class="s2">&quot;prepare_fn&quot;</span> <span class="o">=</span> <span class="s2">&quot;_ZN9doris_udf14AddUdf_prepareEPNS_15FunctionContextENS0_18FunctionStateScopeE&quot;</span><span class="p">,</span>
	<span class="s2">&quot;close_fn&quot;</span> <span class="o">=</span> <span class="s2">&quot;_ZN9doris_udf12AddUdf_closeEPNS_15FunctionContextENS0_18FunctionStateScopeE&quot;</span><span class="p">,</span>
	<span class="s2">&quot;object_file&quot;</span> <span class="o">=</span> <span class="s2">&quot;http://host:port/libmyadd.so&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a custom aggregation function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">AGGREGATE</span> <span class="n">FUNCTION</span> <span class="n">my_count</span> <span class="p">(</span><span class="n">BIGINT</span><span class="p">)</span> <span class="n">RETURNS</span> <span class="n">BIGINT</span> <span class="n">PROPERTIES</span> <span class="p">(</span>
	<span class="s2">&quot;init_fn&quot;</span><span class="o">=</span> <span class="s2">&quot;_ZN9doris_udf6AddUdfEPNS_15FunctionContextERKNS_6IntValES4_&quot;</span><span class="p">,</span>
	<span class="s2">&quot;update_fn&quot;</span> <span class="o">=</span> <span class="s2">&quot;zn9dorisudf11CountupdateepnsFunctionContexterknsIntvalepnsbigintvale&quot;</span><span class="p">,</span>
	<span class="s2">&quot;merge_fn&quot;</span> <span class="o">=</span> <span class="s2">&quot;zn9dorisudf10CountMergeepnsFunctionContexterknsBigintvaleps2</span>
	<span class="s2">&quot;finalize_fn&quot;</span> <span class="o">=</span> <span class="s2">&quot;zn9dorisudf13CountFinalizepnsFunctionContexterknsBigintvale&quot;</span><span class="p">,</span>
	<span class="s2">&quot;object_file&quot;</span> <span class="o">=</span> <span class="s2">&quot;http://host:port/libudasample.so&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
<p>##keyword
CREATE,FUNCTION</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="drop-function_EN.html" class="btn btn-neutral float-right" title="DROP FUNCTION" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="TRUNCATE TABLE_EN.html" class="btn btn-neutral float-left" title="TRUNCATE TABLES" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>