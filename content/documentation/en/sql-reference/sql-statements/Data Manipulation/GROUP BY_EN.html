

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GROUP BY &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="LOAD" href="LOAD_EN.html" />
    <link rel="prev" title="GET LABEL STATE" href="GET LABEL STATE_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../downloads/index.html">Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installing/index.html">Compilation and Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../administrator-guide/index.html">Administrator Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../internal/index.html">Design Documents</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">SQL Manual</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../sql-functions/index.html">SQL Functions</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">DDL Statements</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../Account Management/index.html">Account Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Administration/index.html">Administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Data Definition/index.html">Data Definition</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Data Manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Data Types/index.html">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utility/index.html">Utility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">English</a> &raquo;</li>
        
          <li><a href="../../index.html">SQL Manual</a> &raquo;</li>
        
          <li><a href="../index.html">DDL Statements</a> &raquo;</li>
        
          <li><a href="index.html">Data Manipulation</a> &raquo;</li>
        
      <li>GROUP BY</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/sql-reference/sql-statements/Data Manipulation/GROUP BY_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
--><div class="section" id="group-by">
<h1>GROUP BY<a class="headerlink" href="#group-by" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>GROUP BY <code class="docutils literal notranslate"><span class="pre">GROUPING</span> <span class="pre">SETS</span></code> ｜ <code class="docutils literal notranslate"><span class="pre">CUBE</span></code> ｜ <code class="docutils literal notranslate"><span class="pre">ROLLUP</span></code> is an extension to  GROUP BY clause. This syntax lets you define multiple groupings in the same query. GROUPING SETS produce a single result set that is equivalent to a UNION ALL of differently grouped rows
For example GROUPING SETS clause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span> <span class="n">c</span> <span class="p">)</span> <span class="n">FROM</span> <span class="n">tab1</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">GROUPING</span> <span class="n">SETS</span> <span class="p">(</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="p">(</span> <span class="p">)</span> <span class="p">);</span>
</pre></div>
</div>
<p>This statement is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span> <span class="n">c</span> <span class="p">)</span> <span class="n">FROM</span> <span class="n">tab1</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<span class="n">UNION</span>
<span class="n">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span> <span class="n">c</span> <span class="p">)</span> <span class="n">FROM</span> <span class="n">tab1</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">a</span>
<span class="n">UNION</span>
<span class="n">SELECT</span> <span class="n">null</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span> <span class="n">c</span> <span class="p">)</span> <span class="n">FROM</span> <span class="n">tab1</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">b</span>
<span class="n">UNION</span>
<span class="n">SELECT</span> <span class="n">null</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span> <span class="n">c</span> <span class="p">)</span> <span class="n">FROM</span> <span class="n">tab1</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">GROUPING(expr)</span></code> indicates whether a specified column expression in a GROUP BY list is aggregated or not. GROUPING returns 1 for aggregated or 0 for not aggregated in the result set.</p>
<p><code class="docutils literal notranslate"><span class="pre">GROUPING_ID(expr</span>&#160; <span class="pre">[</span> <span class="pre">,</span> <span class="pre">expr</span> <span class="pre">[</span> <span class="pre">,</span> <span class="pre">...</span> <span class="pre">]</span> <span class="pre">])</span></code> describes which of a list of expressions are grouped in a row produced by a GROUP BY query. The GROUPING_ID function simply returns the decimal equivalent of the binary value formed as a result of the concatenation of the values returned by the GROUPING functions.</p>
<div class="section" id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">...</span>
<span class="n">FROM</span> <span class="o">...</span>
<span class="p">[</span> <span class="o">...</span> <span class="p">]</span>
<span class="n">GROUP</span> <span class="n">BY</span> <span class="p">[</span>
    <span class="p">,</span> <span class="o">...</span> <span class="o">|</span>
    <span class="n">GROUPING</span> <span class="n">SETS</span> <span class="p">[,</span> <span class="o">...</span><span class="p">]</span> <span class="p">(</span>  <span class="n">groupSet</span> <span class="p">[</span> <span class="p">,</span> <span class="n">groupSet</span> <span class="p">[</span> <span class="p">,</span> <span class="o">...</span> <span class="p">]</span> <span class="p">]</span> <span class="p">)</span> <span class="o">|</span>
    <span class="n">ROLLUP</span><span class="p">(</span><span class="n">expr</span>  <span class="p">[</span> <span class="p">,</span> <span class="n">expr</span> <span class="p">[</span> <span class="p">,</span> <span class="o">...</span> <span class="p">]</span> <span class="p">])</span> <span class="o">|</span>
    <span class="n">expr</span>  <span class="p">[</span> <span class="p">,</span> <span class="n">expr</span> <span class="p">[</span> <span class="p">,</span> <span class="o">...</span> <span class="p">]</span> <span class="p">]</span> <span class="n">WITH</span> <span class="n">ROLLUP</span> <span class="o">|</span>
    <span class="n">CUBE</span><span class="p">(</span><span class="n">expr</span>  <span class="p">[</span> <span class="p">,</span> <span class="n">expr</span> <span class="p">[</span> <span class="p">,</span> <span class="o">...</span> <span class="p">]</span> <span class="p">])</span> <span class="o">|</span>
    <span class="n">expr</span>  <span class="p">[</span> <span class="p">,</span> <span class="n">expr</span> <span class="p">[</span> <span class="p">,</span> <span class="o">...</span> <span class="p">]</span> <span class="p">]</span> <span class="n">WITH</span> <span class="n">CUBE</span>
    <span class="p">]</span>
<span class="p">[</span> <span class="o">...</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">groupSet</span></code> is a set of expression or column  or it’s alias appearing in the query block’s SELECT list. <code class="docutils literal notranslate"><span class="pre">groupSet</span> <span class="pre">::=</span> <span class="pre">{</span> <span class="pre">(</span> <span class="pre">expr</span>&#160; <span class="pre">[</span> <span class="pre">,</span> <span class="pre">expr</span> <span class="pre">[</span> <span class="pre">,</span> <span class="pre">...</span> <span class="pre">]</span> <span class="pre">]</span> <span class="pre">)}</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">expr</span></code>  is expression or column  or it’s alias appearing in the query block’s SELECT list.</p>
</div>
<div class="section" id="note">
<h3>Note<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h3>
<p>doris supports PostgreSQL like syntax, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span> <span class="n">c</span> <span class="p">)</span> <span class="n">FROM</span> <span class="n">tab1</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">GROUPING</span> <span class="n">SETS</span> <span class="p">(</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="p">(</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span> <span class="n">d</span> <span class="p">)</span> <span class="n">FROM</span> <span class="n">tab1</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">ROLLUP</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span> <span class="n">SUM</span><span class="p">(</span> <span class="n">d</span> <span class="p">)</span> <span class="n">FROM</span> <span class="n">tab1</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">CUBE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ROLLUP(a,b,c)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">GROUPING</span> <span class="pre">SETS</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GROUPING</span> <span class="n">SETS</span> <span class="p">(</span>
<span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">),</span>
<span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">),</span>
<span class="p">(</span> <span class="n">a</span><span class="p">),</span>
<span class="p">(</span> <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">CUBE</span> <span class="pre">(</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">c</span> <span class="pre">)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">GROUPING</span> <span class="pre">SETS</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GROUPING</span> <span class="n">SETS</span> <span class="p">(</span>
<span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="p">),</span>
<span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">),</span>
<span class="p">(</span> <span class="n">a</span><span class="p">,</span>    <span class="n">c</span> <span class="p">),</span>
<span class="p">(</span> <span class="n">a</span>       <span class="p">),</span>
<span class="p">(</span>    <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="p">),</span>
<span class="p">(</span>    <span class="n">b</span>    <span class="p">),</span>
<span class="p">(</span>       <span class="n">c</span> <span class="p">),</span>
<span class="p">(</span>         <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="example">
<h2>example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>This is a simple example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; SELECT * FROM t;
+------+------+------+
| k1   | k2   | k3   |
+------+------+------+
| a    | A    |    1 |
| a    | A    |    2 |
| a    | B    |    1 |
| a    | B    |    3 |
| b    | A    |    1 |
| b    | A    |    4 |
| b    | B    |    1 |
| b    | B    |    5 |
+------+------+------+
8 rows in set (0.01 sec)

&gt; SELECT k1, k2, SUM(k3) FROM t GROUP BY GROUPING SETS ( (k1, k2), (k2), (k1), ( ) );
+------+------+-----------+
| k1   | k2   | sum(`k3`) |
+------+------+-----------+
| b    | B    |         6 |
| a    | B    |         4 |
| a    | A    |         3 |
| b    | A    |         5 |
| NULL | B    |        10 |
| NULL | A    |         8 |
| a    | NULL |         7 |
| b    | NULL |        11 |
| NULL | NULL |        18 |
+------+------+-----------+
9 rows in set (0.06 sec)

&gt; SELECT k1, k2, GROUPING_ID(k1,k2), SUM(k3) FROM t GROUP BY GROUPING SETS ((k1, k2), (k1), (k2), ());
+------+------+---------------+----------------+
| k1   | k2   | grouping_id(k1,k2) | sum(`k3`) |
+------+------+---------------+----------------+
| a    | A    |             0 |              3 |
| a    | B    |             0 |              4 |
| a    | NULL |             1 |              7 |
| b    | A    |             0 |              5 |
| b    | B    |             0 |              6 |
| b    | NULL |             1 |             11 |
| NULL | A    |             2 |              8 |
| NULL | B    |             2 |             10 |
| NULL | NULL |             3 |             18 |
+------+------+---------------+----------------+
9 rows in set (0.02 sec)
</pre></div>
</div>
</div>
<div class="section" id="keyword">
<h2>keyword<a class="headerlink" href="#keyword" title="Permalink to this headline">¶</a></h2>
<p>GROUP, GROUPING, GROUPING_ID, GROUPING_SETS, GROUPING SETS, CUBE, ROLLUP</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="LOAD_EN.html" class="btn btn-neutral float-right" title="LOAD" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="GET LABEL STATE_EN.html" class="btn btn-neutral float-left" title="GET LABEL STATE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>