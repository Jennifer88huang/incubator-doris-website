

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>STREAM LOAD &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="INSERT" href="insert_EN.html" />
    <link rel="prev" title="STOP ROUTINE LOAD" href="STOP ROUTINE LOAD_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../installing/index.html">Compilation and deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../getting-started/index.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../administrator-guide/index.html">Administrator Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../internal/index.html">Design Documents</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">SQL Manual</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../sql-functions/index.html">SQL Functions</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">DDL Statements</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../Account Management/index.html">Account Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Administration/index.html">Administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Data Definition/index.html">Data Definition</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Data Manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Data Types/index.html">Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Utility/index.html">Utility</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">English</a> &raquo;</li>
        
          <li><a href="../../index.html">SQL Manual</a> &raquo;</li>
        
          <li><a href="../index.html">DDL Statements</a> &raquo;</li>
        
          <li><a href="index.html">Data Manipulation</a> &raquo;</li>
        
      <li>STREAM LOAD</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/sql-reference/sql-statements/Data Manipulation/STREAM LOAD_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stream-load">
<h1>STREAM LOAD<a class="headerlink" href="#stream-load" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>NAME</p>
<p>load data to table in streaming</p>
<p>SYNOPSIS</p>
<p>Curl –location-trusted -u user:passwd [-H “”…] -T data.file -XPUT http://fe_host:http_port/api/{db}/{table}/_stream_load</p>
<p>DESCRIPTION</p>
<p>This statement is used to load data to the specified table. The difference from normal load is that this load method is synchronous load.</p>
<p>This type of load still guarantees the atomicity of a batch of load tasks, either all data is loaded successfully or all fails.</p>
<p>This operation also updates the data for the rollup table associated with this base table.</p>
<p>This is a synchronous operation that returns the results to the user after the entire data load is completed.</p>
<p>Currently, HTTP chunked and non-chunked uploads are supported. For non-chunked mode, Content-Length must be used to indicate the length of the uploaded content, which ensures data integrity.</p>
<p>In addition, the user preferably sets the Content of the Expect Header field to 100-continue, which avoids unnecessary data transmission in certain error scenarios.</p>
<p>OPTIONS</p>
<p>Users can pass in the load parameters through the Header part of HTTP.</p>
<p><code class="docutils literal notranslate"><span class="pre">label</span></code></p>
<p>A label that is loaded at one time. The data of the same label cannot be loaded multiple times. Users can avoid the problem of repeated data load by specifying the label.</p>
<p>Currently Palo internally retains the most recent successful label within 30 minutes.</p>
<p><code class="docutils literal notranslate"><span class="pre">column_separator</span></code></p>
<p>Used to specify the column separator in the load file. The default is <code class="docutils literal notranslate"><span class="pre">\t</span></code>. If it is an invisible character, you need to add <code class="docutils literal notranslate"><span class="pre">\x</span></code> as a prefix and hexadecimal to indicate the separator.</p>
<p>For example, the separator <code class="docutils literal notranslate"><span class="pre">\x01</span></code> of the hive file needs to be specified as <code class="docutils literal notranslate"><span class="pre">-H</span> <span class="pre">&quot;column_separator:\x01&quot;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">columns</span></code></p>
<p>used to specify the correspondence between the columns in the load file and the columns in the table. If the column in the source file corresponds exactly to the contents of the table, then it is not necessary to specify the contents of this field.&nbsp;If the source file does not correspond to the table schema, then this field is required for some data conversion. There are two forms of column, one is directly corresponding to the field in the load file, directly using the field name to indicate.</p>
<p>One is a derived column with the syntax <code class="docutils literal notranslate"><span class="pre">column_name</span></code> = expression. Give a few examples to help understand.</p>
<p>Example 1: There are three columns “c1, c2, c3” in the table. The three columns in the source file correspond to “c3, c2, c1” at a time; then you need to specify <code class="docutils literal notranslate"><span class="pre">-H</span> <span class="pre">&quot;columns:</span> <span class="pre">c3,</span> <span class="pre">c2,</span> <span class="pre">c1&quot;</span></code></p>
<p>Example 2: There are three columns in the table, “c1, c2, c3”. The first three columns in the source file correspond in turn, but there are more than one column; then you need to specify<code class="docutils literal notranslate"> <span class="pre">-H</span> <span class="pre">&quot;columns:</span> <span class="pre">c1,</span> <span class="pre">c2,</span> <span class="pre">c3,</span> <span class="pre">xxx&quot;</span></code></p>
<p>The last column can optionally specify a name for the placeholder.</p>
<p>Example 3: There are three columns in the table, “year, month, day”. There is only one time column in the source file, which is “2018-06-01 01:02:03” format. Then you can specify <code class="docutils literal notranslate"><span class="pre">-H</span> <span class="pre">&quot;columns:</span> <span class="pre">col,</span> <span class="pre">year</span> <span class="pre">=</span> <span class="pre">year(col),</span> <span class="pre">month=month(col),</span> <span class="pre">day=day(col)&quot;</span></code> to complete the load.</p>
<p><code class="docutils literal notranslate"><span class="pre">where</span></code></p>
<p>Used to extract some data. If the user needs to filter out the unwanted data, it can be achieved by setting this option.</p>
<p>Example 1: load only data larger than k1 column equal to 20180601, then you can specify -H “where: k1 = 20180601” when loading</p>
<p><code class="docutils literal notranslate"><span class="pre">max_filter_ratio</span></code></p>
<p>The maximum proportion of data that can be filtered (for reasons such as data irregularity). The default is zero tolerance. Data non-standard does not include rows that are filtered out by the where condition.</p>
<p><code class="docutils literal notranslate"><span class="pre">Partitions</span></code></p>
<p>Used to specify the partition designed for this load. If the user is able to determine the partition corresponding to the data, it is recommended to specify the item. Data that does not satisfy these partitions will be filtered out.</p>
<p>For example, specify load to p1, p2 partition, <code class="docutils literal notranslate"><span class="pre">-H</span> <span class="pre">&quot;partitions:</span> <span class="pre">p1,</span> <span class="pre">p2&quot;</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Timeout</span></code></p>
<p>Specifies the timeout for the load. Unit seconds. The default is 600 seconds. The range is from 1 second to 259200 seconds.</p>
<p><code class="docutils literal notranslate"><span class="pre">strict_mode</span></code></p>
<p>The user specifies whether strict load mode is enabled for this load. The default is enabled. The shutdown mode is <code class="docutils literal notranslate"><span class="pre">-H</span> <span class="pre">&quot;strict_mode:</span> <span class="pre">false&quot;</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">timezone</span></code></p>
<p>Specifies the time zone used for this load. The default is East Eight District. This parameter affects all function results related to the time zone involved in the load.</p>
<p><code class="docutils literal notranslate"><span class="pre">exec_mem_limit</span></code></p>
<p>Memory limit. Default is 2GB. Unit is Bytes.</p>
<p>RETURN VALUES</p>
<p>After the load is completed, the related content of this load will be returned in Json format. Current field included</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Status</span></code>: load status.<ul>
<li>Success: indicates that the load is successful and the data is visible.</li>
<li>Publish Timeout: Indicates that the load job has been successfully Commit, but for some reason it is not immediately visible. Users can be considered successful and do not have to retry load</li>
<li>Label Already Exists: Indicates that the Label is already occupied by another job, either the load was successful or it is being loaded. The user needs to use the get label state command to determine the subsequent operations.</li>
<li>Other: The load failed, the user can specify Label to retry the job.</li>
</ul>
</li>
<li>Message: A detailed description of the load status. When it fails, it will return the specific reason for failure.</li>
<li>NumberTotalRows: The total number of rows read from the data stream</li>
<li>NumberLoadedRows: The number of data rows loaded this time, only valid when Success</li>
<li>NumberFilteredRows: The number of rows filtered by this load, that is, the number of rows with unqualified data quality.</li>
<li>NumberUnselectedRows: Number of rows that were filtered by the where condition for this load</li>
<li>LoadBytes: The amount of source file data loaded this time</li>
<li>LoadTimeMs: Time spent on this load</li>
<li>ErrorURL: The specific content of the filtered data, only the first 1000 items are retained</li>
</ul>
<p>ERRORS</p>
<p>You can view the load error details by the following statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```SHOW LOAD WARNINGS ON &#39;url&#39;```
</pre></div>
</div>
<p>Where url is the url given by ErrorURL.</p>
</div>
<div class="section" id="example">
<h2>example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p class="first">load the data from the local file ‘testData’ into the table ‘testTbl’ in the database ‘testDb’ and use Label for deduplication. Specify a timeout of 100 seconds</p>
<p><code class="docutils literal notranslate"><span class="pre">Curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-H</span> <span class="pre">&quot;label:123&quot;</span> <span class="pre">-H</span> <span class="pre">&quot;timeout:100&quot;</span> <span class="pre">-T</span> <span class="pre">testData</span> <span class="pre">http://host:port/api/testDb/testTbl/_stream_load</span></code></p>
</li>
<li><p class="first">load the data in the local file ‘testData’ into the table of ‘testTbl’ in the database ‘testDb’, use Label for deduplication, and load only data with k1 equal to 20180601
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<code class="docutils literal notranslate"><span class="pre">Curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-H</span> <span class="pre">&quot;label:123&quot;</span> <span class="pre">-H</span> <span class="pre">&quot;where:</span> <span class="pre">k1=20180601&quot;</span> <span class="pre">-T</span> <span class="pre">testData</span> <span class="pre">http://host:port/api/testDb/testTbl/_stream_load</span></code></p>
</li>
<li><p class="first">load the data from the local file ‘testData’ into the ‘testTbl’ table in the database ‘testDb’, allowing a 20% error rate (user is in defalut_cluster)</p>
<p><code class="docutils literal notranslate"><span class="pre">Curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-H</span> <span class="pre">&quot;label:123&quot;</span> <span class="pre">-H</span> <span class="pre">&quot;max_filter_ratio:0.2&quot;</span> <span class="pre">-T</span> <span class="pre">testData</span> <span class="pre">http://host:port/api/testDb/testTbl/_stream_load</span></code></p>
</li>
<li><p class="first">load the data from the local file ‘testData’ into the ‘testTbl’ table in the database ‘testDb’, allow a 20% error rate, and specify the column name of the file (user is in defalut_cluster)</p>
<p><code class="docutils literal notranslate"><span class="pre">Curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-H</span> <span class="pre">&quot;label:123&quot;</span> <span class="pre">-H</span> <span class="pre">&quot;max_filter_ratio:0.2&quot;</span> <span class="pre">-H</span> <span class="pre">&quot;columns:</span> <span class="pre">k2,</span> <span class="pre">k1,</span> <span class="pre">v1&quot;</span> <span class="pre">-T</span> <span class="pre">testData</span> <span class="pre">http://host:port/api/testDb/testTbl/_stream_load</span></code></p>
</li>
<li><p class="first">load the data from the local file ‘testData’ into the p1, p2 partition in the ‘testTbl’ table in the database ‘testDb’, allowing a 20% error rate.</p>
<p><code class="docutils literal notranslate"><span class="pre">Curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-H</span> <span class="pre">&quot;label:123&quot;</span> <span class="pre">-H</span> <span class="pre">&quot;max_filter_ratio:0.2&quot;</span> <span class="pre">-H</span> <span class="pre">&quot;partitions:</span> <span class="pre">p1,</span> <span class="pre">p2&quot;</span> <span class="pre">-T</span> <span class="pre">testData</span> <span class="pre">http://host:port/api/testDb/testTbl/stream_load</span></code></p>
</li>
<li><p class="first">load using streaming mode (user is in defalut_cluster)</p>
<p><code class="docutils literal notranslate"><span class="pre">Seq</span> <span class="pre">1</span> <span class="pre">10</span> <span class="pre">|</span> <span class="pre">awk</span> <span class="pre">'{OFS=&quot;\t&quot;}{print</span> <span class="pre">$1,</span> <span class="pre">$1</span> <span class="pre">*</span> <span class="pre">10}'</span> <span class="pre">|</span> <span class="pre">curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-T</span> <span class="pre">-</span> <span class="pre">http://host:port/api/testDb/testTbl/_stream_load</span></code></p>
</li>
<li><p class="first">load a table with HLL columns, which can be columns in the table or columns in the data used to generate HLL columns,you can also use empty_hll to supplement columns that are not in the data</p>
<p><code class="docutils literal notranslate"><span class="pre">Curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-H</span> <span class="pre">&quot;columns:</span> <span class="pre">k1,</span> <span class="pre">k2,</span> <span class="pre">v1=hll_hash(k1),</span> <span class="pre">v2=empty_hll()&quot;</span> <span class="pre">-T</span> <span class="pre">testData</span> <span class="pre">http://host:port/api/testDb/testTbl/_stream_load</span></code></p>
</li>
<li><p class="first">load data for strict mode filtering and set the time zone to Africa/Abidjan</p>
<p><code class="docutils literal notranslate"><span class="pre">Curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-H</span> <span class="pre">&quot;strict_mode:</span> <span class="pre">true&quot;</span> <span class="pre">-H</span> <span class="pre">&quot;timezone:</span> <span class="pre">Africa/Abidjan&quot;</span> <span class="pre">-T</span> <span class="pre">testData</span> <span class="pre">http://host:port/api/testDb/testTbl/_stream_load</span></code></p>
</li>
<li><p class="first">load a table with an aggregate model of <code class="docutils literal notranslate"><span class="pre">BITMAP_UNION</span></code>, either a column in the table or a column in the data to generate a <code class="docutils literal notranslate"><span class="pre">BITMAP_UNION</span></code> column</p>
<p><code class="docutils literal notranslate"><span class="pre">Curl</span> <span class="pre">--location-trusted</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-H</span> <span class="pre">&quot;columns:</span> <span class="pre">k1,</span> <span class="pre">k2,</span> <span class="pre">v1=to_bitmap(k1)&quot;</span> <span class="pre">-T</span> <span class="pre">testData</span> <span class="pre">http://host:port/api/testDb/testTbl/_stream_load</span></code></p>
</li>
</ol>
</div>
<div class="section" id="keyword">
<h2>keyword<a class="headerlink" href="#keyword" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">STREAM</span><span class="p">,</span> <span class="n">LOAD</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="insert_EN.html" class="btn btn-neutral float-right" title="INSERT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="STOP ROUTINE LOAD_EN.html" class="btn btn-neutral float-left" title="STOP ROUTINE LOAD" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the name of Apache TLP sponsor. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>