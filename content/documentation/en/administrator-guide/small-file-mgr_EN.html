

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>File Manager &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Time zone" href="time-zone_EN.html" />
    <link rel="prev" title="Authority Management" href="privilege_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installing/index.html">Compilation and deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/index.html">Getting started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Administrator Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="load-data/index.html">Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="http-actions/index.html">HTTP API</a></li>
<li class="toctree-l3"><a class="reference internal" href="operation/index.html">Maintainence Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="backup-restore_EN.html">Backup and Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="colocation-join_EN.html">Colocation Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="export_manual_EN.html">Data export</a></li>
<li class="toctree-l3"><a class="reference internal" href="privilege_EN.html">Authority Management</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">File Manager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#noun-interpretation">Noun Interpretation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#basic-concepts">Basic concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specific-operation">Specific operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation-details">Implementation details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#use-restrictions">Use restrictions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relevant-configuration">Relevant configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="time-zone_EN.html">Time zone</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/index.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sql-reference/index.html">SQL Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">English</a> &raquo;</li>
        
          <li><a href="index.html">Administrator Guide</a> &raquo;</li>
        
      <li>File Manager</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/administrator-guide/small-file-mgr_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="file-manager">
<h1>File Manager<a class="headerlink" href="#file-manager" title="Permalink to this headline">¶</a></h1>
<p>Some functions in Doris require some user-defined files. For example, public keys, key files, certificate files and so on are used to access external data sources. The File Manager provides a function that allows users to upload these files in advance and save them in Doris system, which can then be referenced or accessed in other commands.</p>
<div class="section" id="noun-interpretation">
<h2>Noun Interpretation<a class="headerlink" href="#noun-interpretation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>FE: Frontend, the front-end node of Doris. Responsible for metadata management and request access.</li>
<li>BE: Backend, Doris’s back-end node. Responsible for query execution and data storage.</li>
<li>BDBJE: Oracle Berkeley DB Java Edition. Distributed embedded database for persistent metadata in FE.</li>
<li>SmallFileMgr: File Manager. Responsible for creating and maintaining user files.</li>
</ul>
</div>
<div class="section" id="basic-concepts">
<h2>Basic concepts<a class="headerlink" href="#basic-concepts" title="Permalink to this headline">¶</a></h2>
<p>Files are files created and saved by users in Doris.</p>
<p>A file is located by <code class="docutils literal notranslate"><span class="pre">database</span></code>, <code class="docutils literal notranslate"><span class="pre">catalog</span></code>, <code class="docutils literal notranslate"><span class="pre">file_name</span></code>. At the same time, each file also has a globally unique ID (file_id), which serves as the identification in the system.</p>
<p>File creation and deletion can only be performed by users with <code class="docutils literal notranslate"><span class="pre">admin</span></code> privileges. A file belongs to a database. Users who have access to a database (queries, imports, modifications, etc.) can use the files created under the database.</p>
</div>
<div class="section" id="specific-operation">
<h2>Specific operation<a class="headerlink" href="#specific-operation" title="Permalink to this headline">¶</a></h2>
<p>File management has three main commands: <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">FILE</span></code>, <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">FILE</span></code> and <code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">FILE</span></code>, creating, viewing and deleting files respectively. The specific syntax of these three commands can be viewed by connecting to Doris and executing <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">cmd;</span></code>.</p>
<ol>
<li><p class="first">CREATE FILE</p>
<p>In the command to create a file, the user must provide the following information:</p>
<ul>
<li><p class="first">file_name: File name. User-defined, unique within a catalog.</p>
</li>
<li><p class="first">Catalog: Category of files. User-defined, unique within a database.</p>
<blockquote>
<div><p>Doris also has some special classification names for specific commands.</p>
</div></blockquote>
<blockquote>
<div><ol class="simple">
<li>Kafka</li>
</ol>
</div></blockquote>
<blockquote>
<div><p>When the data source is specified as Kafka in the routine Import command and the file needs to be referenced, Doris defaults to looking for the file from the catalog category named “kafka”.</p>
</div></blockquote>
</li>
<li><p class="first">url: the download address of the file. Currently, only unauthenticated HTTP download addresses are supported. This download address is only used to download files from this address when executing the create file command. When the file is successfully created and saved in Doris, the address will no longer be used.</p>
</li>
<li><p class="first">md5: optional. The MD5 value of the file. If the user provides this value, the MD5 value will be checked after the file is downloaded. File creation fails if validation fails.</p>
</li>
</ul>
<p>When the file is created successfully, the file-related information will be persisted in Doris. Users can view successfully created files through the <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">FILE</span></code> command.</p>
</li>
<li><p class="first">SHOW FILE</p>
<p>This command allows you to view files that have been created successfully. Specific operations see: <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">SHOW</span> <span class="pre">FILE;</span></code></p>
</li>
<li><p class="first">DROP FILE</p>
<p>This command can delete a file that has been created. Specific operations see: <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">DROP</span> <span class="pre">FILE;</span></code></p>
</li>
</ol>
</div>
<div class="section" id="implementation-details">
<h2>Implementation details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-and-delete-files">
<h3>Create and delete files<a class="headerlink" href="#create-and-delete-files" title="Permalink to this headline">¶</a></h3>
<p>When the user executes the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">FILE</span></code> command, FE downloads the file from a given URL. The contents of the file are stored in FE memory directly in the form of Base64 encoding. At the same time, the file content and meta-information related to the file will be persisted in BDBJE. All created files, their meta-information and file content reside in FE memory. If the FE goes down and restarts, meta information and file content will also be loaded into memory from the BDBJE. When a file is deleted, the relevant information is deleted directly from FE memory and persistent information is deleted from BDBJE.</p>
</div>
<div class="section" id="use-of-documents">
<h3>Use of documents<a class="headerlink" href="#use-of-documents" title="Permalink to this headline">¶</a></h3>
<p>If the FE side needs to use the created file, SmallFileMgr will directly save the data in FE memory as a local file, store it in the specified directory, and return the local file path for use.</p>
<p>If the BE side needs to use the created file, BE will download the file content to the specified directory on BE through FE’s HTTP interface <code class="docutils literal notranslate"><span class="pre">api/get_small_file</span></code> for use. At the same time, BE also records the information of the files that have been downloaded in memory. When BE requests a file, it first checks whether the local file exists and verifies it. If the validation passes, the local file path is returned directly. If the validation fails, the local file is deleted and downloaded from FE again. When BE restarts, local files are preloaded into memory.</p>
</div>
</div>
<div class="section" id="use-restrictions">
<h2>Use restrictions<a class="headerlink" href="#use-restrictions" title="Permalink to this headline">¶</a></h2>
<p>Because the file meta-information and content are stored in FE memory. So by default, only files with size less than 1MB can be uploaded. And the total number of files is limited to 100. The configuration items described in the next section can be modified.</p>
</div>
<div class="section" id="relevant-configuration">
<h2>Relevant configuration<a class="headerlink" href="#relevant-configuration" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li>FE configuration</li>
</ol>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">Small_file_dir</span></code>: The path used to store uploaded files, defaulting to the <code class="docutils literal notranslate"><span class="pre">small_files/</span></code> directory of the FE runtime directory.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">max_small_file_size_bytes</span></code>: A single file size limit in bytes. The default is 1MB. File creation larger than this configuration will be rejected.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">max_small_file_number</span></code>: The total number of files supported by a Doris cluster. The default is 100. When the number of files created exceeds this value, subsequent creation will be rejected.</p>
<blockquote>
<div><p>If you need to upload more files or increase the size limit of a single file, you can modify the <code class="docutils literal notranslate"><span class="pre">max_small_file_size_bytes</span></code> and <code class="docutils literal notranslate"><span class="pre">max_small_file_number</span></code> parameters by using the <code class="docutils literal notranslate"><span class="pre">ADMIN</span> <span class="pre">SET</span> <span class="pre">CONFIG</span></code> command. However, the increase in the number and size of files will lead to an increase in FE memory usage.</p>
</div></blockquote>
</li>
</ul>
<ol class="simple">
<li>BE 配置</li>
</ol>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Small_file_dir</span></code>: The path used to store files downloaded from FE by default is in the <code class="docutils literal notranslate"><span class="pre">lib/small_files/</span></code> directory of the BE runtime directory.</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="time-zone_EN.html" class="btn btn-neutral float-right" title="Time zone" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="privilege_EN.html" class="btn btn-neutral float-left" title="Authority Management" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the name of Apache TLP sponsor. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>