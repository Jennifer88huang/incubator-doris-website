

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Temporary partition &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="HTTP API" href="../http-actions/index.html" />
    <link rel="prev" title="Scheam Change" href="alter-table-schema-change_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../downloads/index.html">Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing/index.html">Compilation and Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Administrator Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../load-data/index.html">Load Data</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Schema Change</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="alter-table-bitmap-index_EN.html">Bitmap Index</a></li>
<li class="toctree-l4"><a class="reference internal" href="alter-table-rollup_EN.html">Rollup</a></li>
<li class="toctree-l4"><a class="reference internal" href="alter-table-schema-change_EN.html">Scheam Change</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Temporary partition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../http-actions/index.html">HTTP API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operation/index.html">Maintainence Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/index.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../backup-restore_EN.html">Backup and Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../broker_EN.html">Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../colocation-join_EN.html">Colocation Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dynamic-partition_EN.html">Dynamic Partition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../export_manual_EN.html">Data export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../privilege_EN.html">Authority Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../small-file-mgr_EN.html">File Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql-mode_EN.html">SQL MODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time-zone_EN.html">Time zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../variables_EN.html">Variable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal/index.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql-reference/index.html">SQL Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">English</a> &raquo;</li>
        
          <li><a href="../index.html">Administrator Guide</a> &raquo;</li>
        
          <li><a href="index.html">Schema Change</a> &raquo;</li>
        
      <li>Temporary partition</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/administrator-guide/alter-table/alter-table-temp-partition_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
--><div class="section" id="temporary-partition">
<h1>Temporary partition<a class="headerlink" href="#temporary-partition" title="Permalink to this headline">¶</a></h1>
<p>Since version 0.12, Doris supports temporary partitioning.</p>
<p>A temporary partition belongs to a partitioned table. Only partitioned tables can create temporary partitions.</p>
<div class="section" id="rules">
<h2>Rules<a class="headerlink" href="#rules" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The partition columns of the temporary partition is the same as the formal partition and cannot be modified.</li>
<li>The partition ranges of all temporary partitions of a table cannot overlap, but the ranges of temporary partitions and formal partitions can overlap.</li>
<li>The partition name of the temporary partition cannot be the same as the formal partitions and other temporary partitions.</li>
</ul>
</div>
<div class="section" id="supported-operations">
<h2>Supported operations<a class="headerlink" href="#supported-operations" title="Permalink to this headline">¶</a></h2>
<p>The temporary partition supports add, delete, and replace operations.</p>
<div class="section" id="add-temporary-partition">
<h3>Add temporary partition<a class="headerlink" href="#add-temporary-partition" title="Permalink to this headline">¶</a></h3>
<p>You can add temporary partitions to a table with the <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">ADD</span> <span class="pre">TEMPORARY</span> <span class="pre">PARTITION</span></code> statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl1</span> <span class="n">ADD</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="n">tp1</span> <span class="n">VALUES</span> <span class="n">LESS</span> <span class="n">THAN</span> <span class="p">(</span><span class="s2">&quot;2020-02-01&quot;</span><span class="p">);</span>

<span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl2</span> <span class="n">ADD</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="n">tp1</span> <span class="n">VALUES</span> <span class="p">[(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;2020-02-01&quot;</span><span class="p">));</span>

<span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl1</span> <span class="n">ADD</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="n">tp1</span> <span class="n">VALUES</span> <span class="n">LESS</span> <span class="n">THAN</span> <span class="p">(</span><span class="s2">&quot;2020-02-01&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="s2">&quot;in_memory&quot;</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span> <span class="s2">&quot;replication_num&quot;</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
<span class="n">DISTRIBUTED</span> <span class="n">BY</span> <span class="n">HASH</span> <span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="n">BUCKETS</span> <span class="mi">5</span><span class="p">;</span>
</pre></div>
</div>
<p>See <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">ALTER</span> <span class="pre">TABLE;</span></code> for more help and examples.</p>
<p>Some instructions for adding operations:</p>
<ul class="simple">
<li>Adding a temporary partition is similar to adding a formal partition. The partition range of the temporary partition is independent of the formal partition.</li>
<li>Temporary partition can independently specify some attributes. Includes information such as the number of buckets, the number of replicas, whether it is a memory table, or the storage medium.</li>
</ul>
</div>
<div class="section" id="delete-temporary-partition">
<h3>Delete temporary partition<a class="headerlink" href="#delete-temporary-partition" title="Permalink to this headline">¶</a></h3>
<p>A table’s temporary partition can be dropped with the <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">DROP</span> <span class="pre">TEMPORARY</span> <span class="pre">PARTITION</span></code> statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl1</span> <span class="n">DROP</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="n">tp1</span><span class="p">;</span>
</pre></div>
</div>
<p>See <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">ALTER</span> <span class="pre">TABLE;</span></code> for more help and examples.</p>
<p>Some instructions for the delete operation:</p>
<ul class="simple">
<li>Deleting the temporary partition will not affect the data of the formal partition.</li>
</ul>
</div>
<div class="section" id="replace-partition">
<h3>Replace partition<a class="headerlink" href="#replace-partition" title="Permalink to this headline">¶</a></h3>
<p>You can replace formal partitions of a table with temporary partitions with the <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span> <span class="pre">REPLACE</span> <span class="pre">PARTITION</span></code> statement.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl1</span> <span class="n">REPLACE</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="n">WITH</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">tp1</span><span class="p">);</span>

<span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl1</span> <span class="n">REPLACE</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="n">WITH</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">tp2</span><span class="p">,</span> <span class="n">tp3</span><span class="p">);</span>

<span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl1</span> <span class="n">REPLACE</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="n">WITH</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">tp2</span><span class="p">)</span>
<span class="n">PROPERTIES</span> <span class="p">(</span>
    <span class="s2">&quot;strict_range&quot;</span> <span class="o">=</span> <span class="s2">&quot;false&quot;</span><span class="p">,</span>
    <span class="s2">&quot;use_temp_partition_name&quot;</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>See <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">ALTER</span> <span class="pre">TABLE;</span></code> for more help and examples.</p>
<p>The replace operation has two special optional parameters:</p>
<ol>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">strict_range</span></code></p>
<p>The default is true. When this parameter is true, the range union of all formal partitions to be replaced needs to be the same as the range union of the temporary partitions to be replaced. When set to false, you only need to ensure that the range between the new formal partitions does not overlap after replacement. Here are some examples:</p>
<ul>
<li><p class="first">Example 1</p>
<p>Range of partitions p1, p2, p3 to be replaced (=&gt; union):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Replace the range of partitions tp1, tp2 (=&gt; union):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>The union of ranges is the same, so you can use tp1 and tp2 to replace p1, p2, p3.</p>
</li>
<li><p class="first">Example 2</p>
<p>Range of partition p1 to be replaced (=&gt; union):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Replace the range of partitions tp1, tp2 (=&gt; union):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>The union of ranges is not the same. If <code class="docutils literal notranslate"><span class="pre">strict_range</span></code> is true, you cannot use tp1 and tp2 to replace p1. If false, and the two partition ranges <code class="docutils literal notranslate"><span class="pre">[10,</span> <span class="pre">30),</span> <span class="pre">[40,</span> <span class="pre">50)</span></code> and the other formal partitions do not overlap, they can be replaced.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">use_temp_partition_name</span></code></p>
<p>The default is false. When this parameter is false, and the number of partitions to be replaced is the same as the number of replacement partitions, the name of the formal partition after the replacement remains unchanged. If true, after replacement, the name of the formal partition is the name of the replacement partition. Here are some examples:</p>
<ul>
<li><p class="first">Example 1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl1</span> <span class="n">REPLACE</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="n">WITH</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">tp1</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">use_temp_partition_name</span></code> is false by default. After replacement, the partition name is still p1, but the related data and attributes are replaced with tp1.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">use_temp_partition_name</span></code> is true by default, the name of the partition is tp1 after replacement. The p1 partition no longer exists.</p>
</li>
<li><p class="first">Example 2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">tbl1</span> <span class="n">REPLACE</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="n">WITH</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">tp1</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">use_temp_partition_name</span></code> is false by default, but this parameter is invalid because the number of partitions to be replaced and the number of replacement partitions are different. After the replacement, the partition name is tp1, and p1 and p2 no longer exist.</p>
</li>
</ul>
</li>
</ol>
<p>Some instructions for the replacement operation:</p>
<ul class="simple">
<li>After the partition is replaced successfully, the replaced partition will be deleted and cannot be recovered.</li>
</ul>
</div>
</div>
<div class="section" id="load-and-query-of-temporary-partitions">
<h2>Load and query of temporary partitions<a class="headerlink" href="#load-and-query-of-temporary-partitions" title="Permalink to this headline">¶</a></h2>
<p>Users can load data into temporary partitions or specify temporary partitions for querying.</p>
<ol>
<li><p class="first">Load temporary partition</p>
<p>The syntax for specifying a temporary partition is slightly different depending on the load method. Here is a simple illustration through an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">tbl</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">tp2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span> <span class="n">SELECT</span> <span class="o">....</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">location</span><span class="o">-</span><span class="n">trusted</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span><span class="p">:</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;label: 123&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;temporary_partition: tp1, tp2, ...&quot;</span> <span class="o">-</span><span class="n">T</span> <span class="n">testData</span> <span class="n">http</span><span class="p">:</span> <span class="o">//</span> <span class="n">host</span><span class="p">:</span> <span class="n">port</span> <span class="o">/</span> <span class="n">api</span> <span class="o">/</span> <span class="n">testDb</span> <span class="o">/</span> <span class="n">testTbl</span> <span class="o">/</span> <span class="n">_stream_load</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LOAD LABEL example_db.label1
(
DATA INFILE (&quot;hdfs: // hdfs_host: hdfs_port / user / palo / data / input / file&quot;)
INTO TABLE `my_table`
TEMPORARY PARTITION (tp1, tp2, ...)
...
)
WITH BROKER hdfs (&quot;username&quot; = &quot;hdfs_user&quot;, &quot;password&quot; = &quot;hdfs_password&quot;);
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">ROUTINE</span> <span class="n">LOAD</span> <span class="n">example_db</span><span class="o">.</span><span class="n">test1</span> <span class="n">ON</span> <span class="n">example_tbl</span>
<span class="n">COLUMNS</span> <span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">k1</span> <span class="o">*</span> <span class="mi">100</span><span class="p">),</span>
<span class="n">TEMPORARY</span> <span class="n">PARTITIONS</span> <span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">tp2</span><span class="p">,</span> <span class="o">...</span><span class="p">),</span>
<span class="n">WHERE</span> <span class="n">k1</span><span class="o">&gt;</span> <span class="mi">100</span>
<span class="n">PROPERTIES</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">FROM</span> <span class="n">KAFKA</span>
<span class="p">(</span><span class="o">...</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">Query the temporary partition</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">...</span> <span class="n">FROM</span>
<span class="n">tbl1</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">tp2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">JOIN</span>
<span class="n">tbl2</span> <span class="n">TEMPORARY</span> <span class="n">PARTITION</span> <span class="p">(</span><span class="n">tp1</span><span class="p">,</span> <span class="n">tp2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">ON</span> <span class="o">...</span>
<span class="n">WHERE</span> <span class="o">...</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="relationship-to-other-operations">
<h2>Relationship to other operations<a class="headerlink" href="#relationship-to-other-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="drop">
<h3>DROP<a class="headerlink" href="#drop" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>After using the <code class="docutils literal notranslate"><span class="pre">DROP</span></code> operation to directly drop the database or table, you can recover the database or table (within a limited time) through the <code class="docutils literal notranslate"><span class="pre">RECOVER</span></code> command, but the temporary partition will not be recovered.</li>
<li>After the formal partition is dropped using the <code class="docutils literal notranslate"><span class="pre">ALTER</span></code> command, the partition can be recovered by the <code class="docutils literal notranslate"><span class="pre">RECOVER</span></code> command (within a limited time). Operating a formal partition is not related to a temporary partition.</li>
<li>After the temporary partition is dropped using the <code class="docutils literal notranslate"><span class="pre">ALTER</span></code> command, the temporary partition cannot be recovered through the <code class="docutils literal notranslate"><span class="pre">RECOVER</span></code> command.</li>
</ul>
</div>
<div class="section" id="truncate">
<h3>TRUNCATE<a class="headerlink" href="#truncate" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Use the <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code> command to empty the table. The temporary partition of the table will be deleted and cannot be recovered.</li>
<li>When using <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code> command to empty the formal partition, it will not affect the temporary partition.</li>
<li>You cannot use the <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code> command to empty the temporary partition.</li>
</ul>
</div>
<div class="section" id="alter">
<h3>ALTER<a class="headerlink" href="#alter" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>When the table has a temporary partition, you cannot use the <code class="docutils literal notranslate"><span class="pre">ALTER</span></code> command to perform Schema Change, Rollup, etc. on the table.</li>
<li>You cannot add temporary partitions to a table while the table is undergoing a alter operation.</li>
</ul>
</div>
</div>
<div class="section" id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p class="first">Atomic overwrite</p>
<p>In some cases, the user wants to be able to rewrite the data of a certain partition, but if it is dropped first and then loaded, there will be a period of time when the data cannot be seen. This is, the user can first create a corresponding temporary partition, load new data into the temporary partition, and then replace the original partition atomically through the <code class="docutils literal notranslate"><span class="pre">REPLACE</span></code> operation to achieve the purpose.</p>
</li>
<li><p class="first">Modify the number of buckets</p>
<p>In some cases, the user used an inappropriate number of buckets when creating a partition. The user can first create a temporary partition corresponding to the partition range and specify a new number of buckets. Then use the <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">INTO</span></code> command to load the data of the formal partition into the temporary partition. Through the replacement operation, the original partition is replaced atomically to achieve the purpose.</p>
</li>
<li><p class="first">Merge or split partitions</p>
<p>In some cases, users want to modify the range of partitions, such as merging two partitions, or splitting a large partition into multiple smaller partitions. Then the user can first create temporary partitions corresponding to the merged or divided range, and then load the data of the formal partition into the temporary partition through the <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">INTO</span></code> command. Through the replacement operation, the original partition is replaced atomically to achieve the purpose.</p>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../http-actions/index.html" class="btn btn-neutral float-right" title="HTTP API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="alter-table-schema-change_EN.html" class="btn btn-neutral float-left" title="Scheam Change" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>