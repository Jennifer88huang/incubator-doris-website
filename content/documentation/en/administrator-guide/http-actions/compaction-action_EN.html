

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Compaction Action &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="get_log_file" href="fe-get-log-file_EN.html" />
    <link rel="prev" title="CANCEL LABEL" href="cancel-label_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../downloads/index.html">Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing/index.html">Compilation and Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Administrator Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../load-data/index.html">Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alter-table/index.html">Schema Change</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">HTTP API</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cancel-label_EN.html">CANCEL LABEL</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Compaction Action</a></li>
<li class="toctree-l4"><a class="reference internal" href="fe-get-log-file_EN.html">get_log_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="get-label-state_EN.html">GET LABEL STATE</a></li>
<li class="toctree-l4"><a class="reference internal" href="restore-tablet_EN.html">RESTORE TABLET</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../operation/index.html">Maintainence Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/index.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../backup-restore_EN.html">Backup and Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../broker_EN.html">Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../colocation-join_EN.html">Colocation Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dynamic-partition_EN.html">Dynamic Partition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../export_manual_EN.html">Data export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../privilege_EN.html">Authority Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../small-file-mgr_EN.html">File Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql-mode_EN.html">SQL MODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time-zone_EN.html">Time zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../variables_EN.html">Variable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal/index.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql-reference/index.html">SQL Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">English</a> &raquo;</li>
        
          <li><a href="../index.html">Administrator Guide</a> &raquo;</li>
        
          <li><a href="index.html">HTTP API</a> &raquo;</li>
        
      <li>Compaction Action</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/administrator-guide/http-actions/compaction-action_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>&lt;!-
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements. See the NOTICE file
distributed with this work for additional information
regarding copyright ownership. The ASF licenses this file
to you under the Apache License, Version 2.0 (the
“License”); you may not use this file except in compliance
with the License. You may obtain a copy of the License at</p>
<p>http://www.apache.org/licenses/LICENSE-2.0</p>
<p>Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
“AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied. See the License for the
specific language governing permissions and limitations
under the License.
-&gt;</p>
<div class="section" id="compaction-action">
<h1>Compaction Action<a class="headerlink" href="#compaction-action" title="Permalink to this headline">¶</a></h1>
<p>This API is used to view the overall compaction status of a BE node or the compaction status of a specified tablet. It can also be used to manually trigger Compaction.</p>
<div class="section" id="view-compaction-status">
<h2>View Compaction status<a class="headerlink" href="#view-compaction-status" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-overall-compaction-status-of-the-node">
<h3>The overall compaction status of the node<a class="headerlink" href="#the-overall-compaction-status-of-the-node" title="Permalink to this headline">¶</a></h3>
<p>(TODO)</p>
</div>
<div class="section" id="specify-the-compaction-status-of-the-tablet">
<h3>Specify the compaction status of the tablet<a class="headerlink" href="#specify-the-compaction-status-of-the-tablet" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -X GET http://be_host:webserver_port/api/compaction/show?tablet_id=xxxx\&amp;schema_hash=yyyy
</pre></div>
</div>
<p>If the tablet does not exist, an error in JSON format is returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Fail&quot;</span><span class="p">,</span>
    <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;Tablet not found&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the tablet exists, the result is returned in JSON format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;cumulative point&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;last cumulative failure time&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-12-16 18:13:43.224&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last base failure time&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-12-16 18:13:23.320&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last cumu success time&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-12-16 18:12:15.110&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last base success time&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-12-16 18:11:50.780&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rowsets&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;[0-48] 10 DATA OVERLAPPING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[49-49] 2 DATA OVERLAPPING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[50-50] 0 DELETE NONOVERLAPPING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;[51-51] 5 DATE OVERLAPPING&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Explanation of results:</p>
<ul class="simple">
<li>cumulative point: The version boundary between base and cumulative compaction. Versions before (excluding) points are handled by base compaction. Versions after (inclusive) are handled by cumulative compaction.</li>
<li>last cumulative failure time: The time when the last cumulative compaction failed. After 10 minutes by default, cumulative compaction is attempted on the this tablet again.</li>
<li>last base failure time: The time when the last base compaction failed. After 10 minutes by default, base compaction is attempted on the this tablet again.</li>
<li>rowsets: The current rowsets collection of this tablet. [0-48] means a rowset with version 0-48. The second number is the number of segments in a rowset. The <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> indicates the delete version. <code class="docutils literal notranslate"><span class="pre">OVERLAPPING</span></code> and <code class="docutils literal notranslate"><span class="pre">NONOVERLAPPING</span></code> indicates whether data between segments is overlap.</li>
</ul>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -X GET http://192.168.10.24:8040/api/compaction/show?tablet_id=10015\&amp;schema_hash=1294206575
</pre></div>
</div>
</div>
</div>
<div class="section" id="manually-trigger-compaction">
<h2>Manually trigger Compaction<a class="headerlink" href="#manually-trigger-compaction" title="Permalink to this headline">¶</a></h2>
<p>(TODO)</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fe-get-log-file_EN.html" class="btn btn-neutral float-right" title="get_log_file" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cancel-label_EN.html" class="btn btn-neutral float-left" title="CANCEL LABEL" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>