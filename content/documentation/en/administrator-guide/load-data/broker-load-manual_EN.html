

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Broker Load &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Stream load" href="stream-load-manual_EN.html" />
    <link rel="prev" title="Introduction Overview" href="load-manual_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../downloads/index.html">Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing/index.html">Compilation and Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Administrator Guide</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Load Data</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="load-manual_EN.html">Introduction Overview</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Broker Load</a></li>
<li class="toctree-l4"><a class="reference internal" href="stream-load-manual_EN.html">Stream load</a></li>
<li class="toctree-l4"><a class="reference internal" href="routine-load-manual_EN.html">Routine Load</a></li>
<li class="toctree-l4"><a class="reference internal" href="insert-into-manual_EN.html">Insert Into</a></li>
<li class="toctree-l4"><a class="reference internal" href="delete-manual_EN.html">Delete</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../alter-table/index.html">Schema Change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../http-actions/index.html">HTTP API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operation/index.html">Maintainence Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/index.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../backup-restore_EN.html">Backup and Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../broker_EN.html">Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../colocation-join_EN.html">Colocation Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dynamic-partition_EN.html">Dynamic Partition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../export_manual_EN.html">Data export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../privilege_EN.html">Authority Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../small-file-mgr_EN.html">File Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql-mode_EN.html">SQL MODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time-zone_EN.html">Time zone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../variables_EN.html">Variable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal/index.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql-reference/index.html">SQL Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">English</a> &raquo;</li>
        
          <li><a href="../index.html">Administrator Guide</a> &raquo;</li>
        
          <li><a href="index.html">Load Data</a> &raquo;</li>
        
      <li>Broker Load</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/administrator-guide/load-data/broker-load-manual_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
--><div class="section" id="broker-load">
<h1>Broker Load<a class="headerlink" href="#broker-load" title="Permalink to this headline">¶</a></h1>
<p>Broker load is an asynchronous import method, and the data source supported depends on the data source supported by the Broker process.</p>
<p>Users need to create Broker load imports through MySQL protocol and check the import results by viewing the import commands.</p>
<div class="section" id="applicable-scenarios">
<h2>Applicable scenarios<a class="headerlink" href="#applicable-scenarios" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Source data in Broker accessible storage systems, such as HDFS.</li>
<li>Data volumes range from tens to hundreds of GB.</li>
</ul>
</div>
<div class="section" id="noun-interpretation">
<h2>Noun Interpretation<a class="headerlink" href="#noun-interpretation" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li>Frontend (FE): Metadata and scheduling nodes of Doris system. In the import process, it is mainly responsible for the generation of import plan and the scheduling of import tasks.</li>
<li>Backend (BE): The computing and storage nodes of Doris system. In the import process, it is mainly responsible for ETL and storage of data.</li>
<li>Broker: Broker is an independent stateless process. It encapsulates the file system interface and provides Doris with the ability to read files in the remote storage system.</li>
<li>Plan: Import the execution plan, and BE executes the import execution plan to import data into Doris system.</li>
</ol>
</div>
<div class="section" id="basic-principles">
<h2>Basic Principles<a class="headerlink" href="#basic-principles" title="Permalink to this headline">¶</a></h2>
<p>After the user submits the import task, FE generates the corresponding plan and distributes the plan to several BEs according to the number of BEs and the size of the file. Each BE performs part of the import data.</p>
<p>BE pulls data from Broker and imports it into the system after transforming the data. All BEs complete the import, and the FE decides whether the import is successful or not.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                 <span class="o">+</span>
                 <span class="o">|</span> <span class="mf">1.</span> <span class="n">user</span> <span class="n">create</span> <span class="n">broker</span> <span class="n">load</span>
                 <span class="n">v</span>
            <span class="o">+----+----+</span>
            <span class="o">|</span>         <span class="o">|</span>
            <span class="o">|</span>   <span class="n">FE</span>    <span class="o">|</span>
            <span class="o">|</span>         <span class="o">|</span>
            <span class="o">+----+----+</span>
                 <span class="o">|</span>
                 <span class="o">|</span> <span class="mf">2.</span> <span class="n">BE</span> <span class="n">etl</span> <span class="ow">and</span> <span class="n">load</span> <span class="n">the</span> <span class="n">data</span>
    <span class="o">+--------------------------+</span>
    <span class="o">|</span>            <span class="o">|</span>             <span class="o">|</span>
<span class="o">+---</span><span class="n">v</span><span class="o">---+</span>     <span class="o">+--</span><span class="n">v</span><span class="o">----+</span>    <span class="o">+---</span><span class="n">v</span><span class="o">---+</span>
<span class="o">|</span>       <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span>  <span class="n">BE</span>   <span class="o">|</span>     <span class="o">|</span>  <span class="n">BE</span>   <span class="o">|</span>    <span class="o">|</span>   <span class="n">BE</span>  <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">+---+-^-+</span>     <span class="o">+---+-^-+</span>    <span class="o">+--+-^--+</span>
    <span class="o">|</span> <span class="o">|</span>           <span class="o">|</span> <span class="o">|</span>         <span class="o">|</span> <span class="o">|</span>
    <span class="o">|</span> <span class="o">|</span>           <span class="o">|</span> <span class="o">|</span>         <span class="o">|</span> <span class="o">|</span> <span class="mf">3.</span> <span class="n">pull</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">broker</span>
<span class="o">+---</span><span class="n">v</span><span class="o">-+-+</span>     <span class="o">+---</span><span class="n">v</span><span class="o">-+-+</span>    <span class="o">+--</span><span class="n">v</span><span class="o">-+--+</span>
<span class="o">|</span>       <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span><span class="n">Broker</span> <span class="o">|</span>     <span class="o">|</span><span class="n">Broker</span> <span class="o">|</span>    <span class="o">|</span><span class="n">Broker</span> <span class="o">|</span>
<span class="o">|</span>       <span class="o">|</span>     <span class="o">|</span>       <span class="o">|</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">+---+-^-+</span>     <span class="o">+---+-^-+</span>    <span class="o">+---+-^-+</span>
    <span class="o">|</span> <span class="o">|</span>           <span class="o">|</span> <span class="o">|</span>          <span class="o">|</span> <span class="o">|</span>
<span class="o">+---</span><span class="n">v</span><span class="o">-+-----------</span><span class="n">v</span><span class="o">-+----------</span><span class="n">v</span><span class="o">-+-+</span>
<span class="o">|</span>       <span class="n">HDFS</span><span class="o">/</span><span class="n">BOS</span><span class="o">/</span><span class="n">AFS</span> <span class="n">cluster</span>       <span class="o">|</span>
<span class="o">|</span>                                  <span class="o">|</span>
<span class="o">+----------------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="basic-operations">
<h2>Basic operations<a class="headerlink" href="#basic-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-a-load">
<h3>Create a load<a class="headerlink" href="#create-a-load" title="Permalink to this headline">¶</a></h3>
<p>Broker load create a data load job</p>
<p>Grammar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOAD</span> <span class="n">LABEL</span> <span class="n">db_name</span><span class="o">.</span><span class="n">label_name</span> 
<span class="p">(</span><span class="n">data_desc</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">WITH</span> <span class="n">BROKER</span> <span class="n">broker_name</span> <span class="n">broker_properties</span>
<span class="p">[</span><span class="n">PROPERTIES</span> <span class="p">(</span><span class="n">key1</span><span class="o">=</span><span class="n">value1</span><span class="p">,</span> <span class="o">...</span> <span class="p">)]</span>

<span class="o">*</span> <span class="n">data_desc</span><span class="p">:</span>

    <span class="n">DATA</span> <span class="n">INFILE</span> <span class="p">(</span><span class="s1">&#39;file_path&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
    <span class="p">[</span><span class="n">NEGATIVE</span><span class="p">]</span>
    <span class="n">INTO</span> <span class="n">TABLE</span> <span class="n">tbl_name</span>
    <span class="p">[</span><span class="n">PARTITION</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">COLUMNS</span> <span class="n">TERMINATED</span> <span class="n">BY</span> <span class="n">separator</span> <span class="p">]</span>
    <span class="p">[(</span><span class="n">col1</span><span class="p">,</span> <span class="o">...</span><span class="p">)]</span>
    <span class="p">[</span><span class="n">SET</span> <span class="p">(</span><span class="n">k1</span><span class="o">=</span><span class="n">f1</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">k2</span><span class="o">=</span><span class="n">f2</span><span class="p">(</span><span class="n">xx</span><span class="p">))]</span>
    <span class="p">[</span><span class="n">WHERE</span> <span class="n">predicate</span><span class="p">]</span>

<span class="o">*</span> <span class="n">broker_properties</span><span class="p">:</span> 

    <span class="p">(</span><span class="n">key1</span><span class="o">=</span><span class="n">value1</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOAD</span> <span class="n">LABEL</span> <span class="n">db1</span><span class="o">.</span><span class="n">label1</span>
<span class="p">(</span>
    <span class="n">DATA</span> <span class="n">INFILE</span><span class="p">(</span><span class="s2">&quot;hdfs://abc.com:8888/user/palo/test/ml/file1&quot;</span><span class="p">)</span>
    <span class="n">INTO</span> <span class="n">TABLE</span> <span class="n">tbl1</span>
    <span class="n">COLUMNS</span> <span class="n">TERMINATED</span> <span class="n">BY</span> <span class="s2">&quot;,&quot;</span>
    <span class="p">(</span><span class="n">tmp_c1</span><span class="p">,</span><span class="n">tmp_c2</span><span class="p">)</span>
    <span class="n">SET</span>
    <span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="n">tmp_c2</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">tmp_c1</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">DATA</span> <span class="n">INFILE</span><span class="p">(</span><span class="s2">&quot;hdfs://abc.com:8888/user/palo/test/ml/file2&quot;</span><span class="p">)</span>
    <span class="n">INTO</span> <span class="n">TABLE</span> <span class="n">tbl2</span>
    <span class="n">COLUMNS</span> <span class="n">TERMINATED</span> <span class="n">BY</span> <span class="s2">&quot;,&quot;</span>
    <span class="p">(</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">)</span>
    <span class="n">where</span> <span class="n">col1</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="p">)</span>
<span class="n">WITH</span> <span class="n">BROKER</span> <span class="s1">&#39;broker&#39;</span>
<span class="p">(</span>
    <span class="s2">&quot;username&quot;</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
    <span class="s2">&quot;password&quot;</span><span class="o">=</span><span class="s2">&quot;pass&quot;</span>
<span class="p">)</span>
<span class="n">PROPERTIES</span>
<span class="p">(</span>
    <span class="s2">&quot;timeout&quot;</span> <span class="o">=</span> <span class="s2">&quot;3600&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Create the imported detailed grammar execution <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">BROKER</span> <span class="pre">LOAD</span> </code> View grammar help. This paper mainly introduces the parametric meaning and points for attention in Broker load’s creation import grammar.</p>
<div class="section" id="label">
<h4>Label<a class="headerlink" href="#label" title="Permalink to this headline">¶</a></h4>
<p>Identity of import task. Each import task has a unique Label within a single database. Label is a user-defined name in the import command. With this Label, users can view the execution of the corresponding import task.</p>
<p>Another function of Label is to prevent users from repeatedly importing the same data. <strong>It is strongly recommended that users use the same label for the same batch of data. Thus, repeated requests for the same batch of data can only be accepted once, guaranteeing at-Most-One semantics</strong></p>
<p>When the corresponding import job status of Label is CANCELLED, it can be used again to submit the import job.</p>
</div>
<div class="section" id="data-description-class-parameters">
<h4>Data Description Class Parameters<a class="headerlink" href="#data-description-class-parameters" title="Permalink to this headline">¶</a></h4>
<p>Data description class parameters mainly refer to the parameters belonging to <code class="docutils literal notranslate"><span class="pre">data_desc</span></code> in Broker load creating import statements. Each group of <code class="docutils literal notranslate"><span class="pre">data_desc</span></code> mainly describes the data source address, ETL function, target table and partition information involved in this import.</p>
<p>The following is a detailed explanation of some parameters of the data description class:</p>
<ul>
<li><p class="first">Multi-table import</p>
<p>Broker load supports a single import task involving multiple tables, and each Broker load import task can implement multiple tables import by declaring multiple tables in multiple <code class="docutils literal notranslate"><span class="pre">data_desc</span></code>. Each individual <code class="docutils literal notranslate"><span class="pre">data_desc</span></code> can also specify the data source address belonging to the table. Broker load guarantees atomic success or failure between multiple tables imported at a single time.</p>
</li>
<li><p class="first">negative</p>
<p><code class="docutils literal notranslate"><span class="pre">data_desc</span></code> can also set up data fetching and anti-importing. This function is mainly used when aggregated columns in data tables are of SUM type. If you want to revoke a batch of imported data. The `negative’parameter can be used as a batch of data. Doris automatically retrieves this batch of data on aggregated columns to eliminate the same batch of data.</p>
</li>
<li><p class="first">partition</p>
<p>In <code class="docutils literal notranslate"><span class="pre">data_desc</span></code>, you can specify the partition information of the table to be imported, but it will not be imported if the data to be imported does not belong to the specified partition. At the same time, data that does not specify a Partition is considered error data.</p>
</li>
<li><p class="first">where predicate</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  The where statement in ```data_desc``` is responsible for filtering the data that has been transformed. The unselected rows which is filtered by where predicate will not be calculated in ```max_filter_ratio``` . If there are more then one where predicate of the same table , the multi where predicate will be merged from different ```data_desc``` and the policy is AND. 
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="import-job-parameters">
<h4>Import job parameters<a class="headerlink" href="#import-job-parameters" title="Permalink to this headline">¶</a></h4>
<p>Import job parameters mainly refer to the parameters in Broker load creating import statement that belong to <code class="docutils literal notranslate"><span class="pre">opt_properties</span></code>. Import operation parameters act on the whole import operation.</p>
<p>The following is a detailed explanation of some parameters of the import operation parameters:</p>
<ul>
<li><p class="first">time out</p>
<p>The time-out of the import job (in seconds) allows the user to set the time-out of each import by himself in <code class="docutils literal notranslate"><span class="pre">opt_properties</span></code>. If the import task is not completed within the set timeout time, it will be cancelled by the system and become CANCELLED. The default import timeout for Broker load is 4 hours.</p>
<p>Usually, the user does not need to manually set the timeout of the import task. When the import cannot be completed within the default timeout time, the task timeout can be set manually.</p>
<blockquote>
<div><p>Recommended timeout</p>
<p>Total File Size (MB) / Slowest Import Speed (MB/s) &gt; timeout 	&gt;((MB) * Number of tables to be imported and related Roll up tables) / (10 * Number of concurrent imports)</p>
</div></blockquote>
<blockquote>
<div><p>The concurrency of imports can be seen in the final configuration of the import system in the document. The current import speed limit is 10MB/s in 10 of the formulas.</p>
</div></blockquote>
<blockquote>
<div><p>For example, a 1G data to be imported contains three Rollup tables, and the current concurrency of imports is 3. The minimum value of timeout is <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">*</span> <span class="pre">1024</span> <span class="pre">*</span> <span class="pre">3)</span> <span class="pre">/</span> <span class="pre">(10</span> <span class="pre">*</span> <span class="pre">3)</span> <span class="pre">=</span> <span class="pre">102</span> <span class="pre">seconds.</span></code></p>
</div></blockquote>
<p>Because the machine environment of each Doris cluster is different and the concurrent query tasks of the cluster are different, the slowest import speed of the user Doris cluster requires the user to guess the import task speed according to the history.</p>
</li>
<li><p class="first">max_filter_ratio</p>
<p>The maximum tolerance rate of the import task is 0 by default, and the range of values is 0-1. When the import error rate exceeds this value, the import fails.</p>
<p>If the user wishes to ignore the wrong row, the import can be successful by setting this parameter greater than 0.</p>
<p>The calculation formula is as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">(dpp.abnorm.ALL</span> <span class="pre">/</span> <span class="pre">(dpp.abnorm.ALL</span> <span class="pre">+</span> <span class="pre">dpp.norm.ALL</span> <span class="pre">)</span> <span class="pre">)</span> <span class="pre">&gt;</span> <span class="pre">max_filter_ratio</span></code></p>
<p><code class="docutils literal notranslate"> <span class="pre">dpp.abnorm.ALL</span></code> denotes the number of rows whose data quality is not up to standard. Such as type mismatch, column mismatch, length mismatch and so on.</p>
<p><code class="docutils literal notranslate"><span class="pre">dpp.norm.ALL</span></code> refers to the number of correct data in the import process. The correct amount of data for the import task can be queried by the <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">LOAD</span></code> command.</p>
<p>The number of rows in the original file = <code class="docutils literal notranslate"><span class="pre">dpp.abnorm.ALL</span> <span class="pre">+</span> <span class="pre">dpp.norm.ALL</span></code></p>
</li>
</ul>
<ul>
<li><p class="first">exec_mem_limit</p>
<p>Memory limit. Default is 2GB. Unit is Bytes.</p>
</li>
</ul>
<ul>
<li><p class="first">strict_mode</p>
<p>Broker load can use <code class="docutils literal notranslate"><span class="pre">strict</span> <span class="pre">mode</span></code>. Use <code class="docutils literal notranslate"><span class="pre">properties</span> <span class="pre">(&quot;strict_mode&quot;</span> <span class="pre">=</span> <span class="pre">&quot;true&quot;)</span></code>  to enable <code class="docutils literal notranslate"><span class="pre">strict</span> <span class="pre">mode</span></code>, default is false</p>
<p>The strict mode means that the column type conversion in the import process is strictly filtered. The strategy of strict filtering is as follows:</p>
<ol class="simple">
<li>For column type conversion, if strict mode is true, the wrong data will be filtered. Error data here refers to the kind of data that the original data is not null and the result is null after participating in column type conversion.</li>
<li>Strict mode does not affect the imported column when it is generated by a function transformation.</li>
<li>For a column type imported that contains scope restrictions, strict mode does not affect it if the original data can normally pass type conversion, but can not pass scope restrictions. For example, if the type is decimal (1,0) and the original data is 10, it falls within the scope of type conversion but not column declaration. This data strict has no effect on it.</li>
</ol>
</li>
</ul>
</div>
<div class="section" id="import-relation-between-strict-mode-source-data">
<h4>Import Relation between strict mode source data<a class="headerlink" href="#import-relation-between-strict-mode-source-data" title="Permalink to this headline">¶</a></h4>
<p>Here’s an example of a column type TinyInt</p>
<blockquote>
<div>Note: When columns in a table allow null values to be imported</div></blockquote>
<table border="1" class="docutils">
<thead>
<tr>
<th>source data</th>
<th>source data example</th>
<th>string to int</th>
<th>strict_mode</th>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>null</td>
<td>\N</td>
<td>N/A</td>
<td>true or false</td>
<td>NULL</td>
</tr>
<tr>
<td>not null</td>
<td>aaa or 2000</td>
<td>NULL</td>
<td>true</td>
<td>invalid data(filtered)</td>
</tr>
<tr>
<td>not null</td>
<td>aaa</td>
<td>NULL</td>
<td>false</td>
<td>NULL</td>
</tr>
<tr>
<td>not null</td>
<td>1</td>
<td>1</td>
<td>true or false</td>
<td>correct data</td>
</tr>
</tbody>
</table><p>Here’s an example of column type Decimal (1,0)</p>
<blockquote>
<div>Note: When columns in a table allow null values to be imported</div></blockquote>
<table border="1" class="docutils">
<thead>
<tr>
<th>source data</th>
<th>source data example</th>
<th>string to int</th>
<th>strict_mode</th>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>null</td>
<td>\N</td>
<td>N/A</td>
<td>true or false</td>
<td>NULL</td>
</tr>
<tr>
<td>not null</td>
<td>aaa</td>
<td>NULL</td>
<td>true</td>
<td>invalid data(filtered)</td>
</tr>
<tr>
<td>not null</td>
<td>aaa</td>
<td>NULL</td>
<td>false</td>
<td>NULL</td>
</tr>
<tr>
<td>not null</td>
<td>1 or 10</td>
<td>1</td>
<td>true or false</td>
<td>correct data</td>
</tr>
</tbody>
</table><blockquote>
<div>Note: Although 10 is a value beyond the range, strict mode does not affect it because its type meets the requirements of decimal. 10 will eventually be filtered in other ETL processes. But it will not be filtered by strict mode.</div></blockquote>
</div>
</div>
<div class="section" id="view-load">
<h3>View load<a class="headerlink" href="#view-load" title="Permalink to this headline">¶</a></h3>
<p>Broker load import mode is asynchronous, so the user must create the imported Label record and use Label in the <strong>view Import command to view the import result</strong>. View import commands are common in all import modes. The specific syntax can be <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">SHOW</span> <span class="pre">LOAD</span></code>.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mysql&gt; show load order by createtime desc limit 1\G
*************************** 1. row ***************************
         JobId: 76391
         Label: label1
         State: FINISHED
      Progress: ETL:N/A; LOAD:100%
          Type: BROKER
       EtlInfo: dpp.abnorm.ALL=15; dpp.norm.ALL=28133376
      TaskInfo: cluster:N/A; timeout(s):10800; max_filter_ratio:5.0E-5
      ErrorMsg: N/A
    CreateTime: 2019-07-27 11:46:42
  EtlStartTime: 2019-07-27 11:46:44
 EtlFinishTime: 2019-07-27 11:46:44
 LoadStartTime: 2019-07-27 11:46:44
LoadFinishTime: 2019-07-27 11:50:16
           URL: http://192.168.1.1:8040/api/_load_error_log?file=__shard_4/error_log_insert_stmt_4bb00753932c491a-a6da6e2725415317_4bb00753932c491a_a6da6e2725415317
    JobDetails: {&quot;ScannedRows&quot;:28133395,&quot;TaskNumber&quot;:1,&quot;FileNumber&quot;:1,&quot;FileSize&quot;:200000}
</pre></div>
</div>
<p>The following is mainly about the significance of viewing the parameters in the return result set of the import command:</p>
<ul>
<li><p class="first">JobId</p>
<p>The unique ID of the import task is different for each import task, which is automatically generated by the system. Unlike Label, JobId will never be the same, while Label can be reused after the import task fails.</p>
</li>
<li><p class="first">Label</p>
<p>Identity of import task.</p>
</li>
<li><p class="first">State</p>
<p>Import the current phase of the task. In the Broker load import process, PENDING and LOADING are the two main import states. If the Broker load is in the PENDING state, it indicates that the current import task is waiting to be executed; the LOADING state indicates that it is executing.</p>
<p>There are two final stages of the import task: CANCELLED and FINISHED. When Load job is in these two stages, the import is completed. CANCELLED is the import failure, FINISHED is the import success.</p>
</li>
<li><p class="first">Progress</p>
<p>Import the progress description of the task. There are two kinds of progress: ETL and LOAD, which correspond to the two stages of the import process, ETL and LOADING. At present, Broker load only has the LOADING stage, so ETL will always be displayed as <code class="docutils literal notranslate"><span class="pre">N/A</span></code>.</p>
<p>The progress range of LOAD is 0-100%.</p>
<p><code class="docutils literal notranslate"> <span class="pre">LOAD</span> <span class="pre">Progress</span> <span class="pre">=</span> <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">tables</span> <span class="pre">currently</span> <span class="pre">completed</span> <span class="pre">/</span> <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">tables</span> <span class="pre">designed</span> <span class="pre">for</span> <span class="pre">this</span> <span class="pre">import</span> <span class="pre">task</span> <span class="pre">*</span> <span class="pre">100%</span></code></p>
<p><strong>If all import tables complete the import, then the progress of LOAD is 99%</strong> import enters the final effective stage, and the progress of LOAD will only be changed to 100% after the entire import is completed.</p>
<p>Import progress is not linear. So if there is no change in progress over a period of time, it does not mean that the import is not being implemented.</p>
</li>
<li><p class="first">Type</p>
<p>Types of import tasks. The type value of Broker load is only BROKER.</p>
</li>
<li><p class="first">Etlinfo</p>
<p>It mainly shows the imported data quantity indicators <code class="docutils literal notranslate"><span class="pre">unselected.rows</span></code>, <code class="docutils literal notranslate"><span class="pre">dpp.norm.ALL</span></code> and <code class="docutils literal notranslate"><span class="pre">dpp.abnorm.ALL</span></code>. The first value shows the rows which has been filtered by where predicate. Users can verify that the error rate of the current import task exceeds max_filter_ratio based on these two indicators.</p>
</li>
<li><p class="first">TaskInfo</p>
<p>It mainly shows the current import task parameters, that is, the user-specified import task parameters when creating the Broker load import task, including <code class="docutils literal notranslate"><span class="pre">cluster</span></code>, <code class="docutils literal notranslate"><span class="pre">timeout</span></code>, and <code class="docutils literal notranslate"><span class="pre">max_filter_ratio</span></code>.</p>
</li>
<li><p class="first">ErrorMsg</p>
<p>When the import task status is CANCELLED, the reason for the failure is displayed in two parts: type and msg. If the import task succeeds, the <code class="docutils literal notranslate"><span class="pre">N/A</span></code> is displayed.</p>
<p>The value meaning of type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>USER_CANCEL: User Canceled Tasks
ETL_RUN_FAIL：Import tasks that failed in the ETL phase
ETL_QUALITY_UNSATISFIED：Data quality is not up to standard, that is, the error rate exceedsmax_filter_ratio
LOAD_RUN_FAIL：Import tasks that failed in the LOADING phase
TIMEOUT：Import task not completed in overtime
UNKNOWN：Unknown import error
</pre></div>
</div>
</li>
<li><p class="first">CreateTime /EtlStartTime /EtlFinishTime /LoadStartTime /LoadFinishTime</p>
<p>These values represent the creation time of the import, the beginning time of the ETL phase, the completion time of the ETL phase, the beginning time of the Loading phase and the completion time of the entire import task, respectively.</p>
<p>Broker load import has no ETL stage, so its EtlStartTime, EtlFinishTime, LoadStartTime are set to the same value.</p>
<p>Import tasks stay in CreateTime for a long time, while LoadStartTime is N/A, which indicates that import tasks are heavily stacked at present. Users can reduce the frequency of import submissions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LoadFinishTime</span> <span class="o">-</span> <span class="n">CreateTime</span> <span class="o">=</span> <span class="n">Time</span> <span class="n">consumed</span> <span class="n">by</span> <span class="n">the</span> <span class="n">entire</span> <span class="kn">import</span> <span class="nn">task</span>
<span class="n">LoadFinishTime</span> <span class="o">-</span> <span class="n">LoadStartTime</span> <span class="o">=</span> <span class="n">The</span> <span class="n">entire</span> <span class="n">Broker</span> <span class="n">load</span> <span class="kn">import</span> <span class="nn">task</span> <span class="n">execution</span> <span class="n">time</span> <span class="o">=</span> <span class="n">the</span> <span class="n">time</span> <span class="n">consumed</span> <span class="n">by</span> <span class="n">the</span> <span class="n">entire</span> <span class="kn">import</span> <span class="nn">task</span> <span class="o">-</span> <span class="n">the</span> <span class="n">time</span> <span class="n">the</span> <span class="kn">import</span> <span class="nn">task</span> <span class="n">waits</span>
</pre></div>
</div>
</li>
<li><p class="first">URL</p>
<p>The error data sample of the import task can be obtained by accessing the URL address. When there is no error data in this import, the URL field is N/A.</p>
</li>
</ul>
</div>
<div class="section" id="cancel-load">
<h3>Cancel load<a class="headerlink" href="#cancel-load" title="Permalink to this headline">¶</a></h3>
<p>When the Broker load job status is not CANCELLED or FINISHED, it can be manually cancelled by the user. When canceling, you need to specify a Label for the import task to be cancelled. Canceling Import command syntax can perform <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">CANCEL</span> <span class="pre">LOAD</span></code> view.</p>
</div>
</div>
<div class="section" id="relevant-system-configuration">
<h2>Relevant System Configuration<a class="headerlink" href="#relevant-system-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fe-configuration">
<h3>FE configuration<a class="headerlink" href="#fe-configuration" title="Permalink to this headline">¶</a></h3>
<p>The following configurations belong to the Broker load system-level configuration, which acts on all Broker load import tasks. Configuration values are adjusted mainly by modifying <code class="docutils literal notranslate"><span class="pre">fe.conf</span></code>.</p>
<ul>
<li><p class="first">min_bytes_per_broker_scanner/max_bytes_per_broker_scanner/max_broker_concurrency</p>
<p>The first two configurations limit the minimum and maximum amount of data processed by a single BE. The third configuration limits the maximum number of concurrent imports for a job. The minimum amount of data processed, the maximum number of concurrencies, the size of source files and the number of BEs in the current cluster <strong>together determine the concurrency of this import</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">concurrent</span> <span class="n">imports</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span> <span class="nb">min</span> <span class="p">(</span><span class="n">source</span> <span class="n">file</span> <span class="n">size</span> <span class="o">/</span> <span class="n">minimum</span> <span class="n">throughput</span><span class="p">,</span> <span class="n">maximum</span> <span class="n">concurrency</span><span class="p">,</span> <span class="n">current</span> <span class="n">number</span> <span class="n">of</span> <span class="n">BE</span> <span class="n">nodes</span><span class="p">)</span>
<span class="n">Processing</span> <span class="n">capacity</span> <span class="n">of</span> <span class="n">this</span> <span class="kn">import</span> <span class="nn">of</span> <span class="n">a</span> <span class="n">single</span> <span class="n">BE</span> <span class="o">=</span> <span class="n">source</span> <span class="n">file</span> <span class="n">size</span> <span class="o">/</span> <span class="n">concurrency</span> <span class="n">of</span> <span class="n">this</span> <span class="kn">import</span>
</pre></div>
</div>
<p>Usually the maximum amount of data supported by an import job is <code class="docutils literal notranslate"><span class="pre">max_bytes_per_broker_scanner</span> <span class="pre">*</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">BE</span> <span class="pre">nodes</span></code>. If you need to import a larger amount of data, you need to adjust the size of the <code class="docutils literal notranslate"><span class="pre">max_bytes_per_broker_scanner</span></code> parameter appropriately.</p>
</li>
</ul>
<p>Default configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```
Parameter name: min_bytes_per_broker_scanner, default 64MB, unit bytes.
Parameter name: max_broker_concurrency, default 10.
Parameter name: max_bytes_per_broker_scanner, default 3G, unit bytes.
```
</pre></div>
</div>
</div>
</div>
<div class="section" id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline">¶</a></h2>
<div class="section" id="application-scenarios">
<h3>Application scenarios<a class="headerlink" href="#application-scenarios" title="Permalink to this headline">¶</a></h3>
<p>The most appropriate scenario to use Broker load is the scenario of raw data in a file system (HDFS, BOS, AFS). Secondly, since Broker load is the only way of asynchronous import in a single import, users can also consider using Broker load if they need to use asynchronous access in importing large files.</p>
</div>
<div class="section" id="data-volume">
<h3>Data volume<a class="headerlink" href="#data-volume" title="Permalink to this headline">¶</a></h3>
<p>We will only discuss the case of a single BE. If the user cluster has more than one BE, the amount of data in the heading below should be multiplied by the number of BEs. For example, if the user has three BEs, then the number below 3G (including) should be multiplied by 3, that is, under 9G (including).</p>
<ul>
<li><p class="first">Below 3G (including)</p>
<p>Users can submit Broker load to create import requests directly.</p>
</li>
<li><p class="first">Over 3G</p>
<p>Since the maximum processing capacity of a single imported BE is 3G, the imported files over 3G need to be imported by adjusting the import parameters of Broker load to achieve the import of large files.</p>
<ol>
<li><p class="first">Modify the maximum number of scans and concurrency of a single BE according to the current number of BEs and the size of the original file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Modify</span> <span class="n">the</span> <span class="n">configuration</span> <span class="ow">in</span> <span class="n">fe</span><span class="o">.</span><span class="n">conf</span>

<span class="n">max_broker_concurrency</span> <span class="o">=</span> <span class="n">BE</span> <span class="n">number</span>
<span class="n">The</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">data</span> <span class="n">processed</span> <span class="n">by</span> <span class="n">a</span> <span class="n">single</span> <span class="n">BE</span> <span class="k">for</span> <span class="n">the</span> <span class="n">current</span> <span class="kn">import</span> <span class="nn">task</span> <span class="o">=</span> <span class="n">the</span> <span class="n">original</span> <span class="n">file</span> <span class="n">size</span> <span class="o">/</span> <span class="n">max_broker_concurrency</span>
<span class="n">Max_bytes_per_broker_scanner</span> <span class="o">&gt;=</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">data</span> <span class="n">processed</span> <span class="n">by</span> <span class="n">a</span> <span class="n">single</span> <span class="n">BE</span> <span class="n">of</span> <span class="n">the</span> <span class="n">current</span> <span class="kn">import</span> <span class="nn">task</span>

<span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">a</span> <span class="mi">100</span><span class="n">G</span> <span class="n">file</span> <span class="k">with</span> <span class="mi">10</span> <span class="n">BEs</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">cluster</span>
<span class="n">max_broker_concurrency</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Max</span><span class="o">================</span>
</pre></div>
</div>
<p>After modification, all BEs process import tasks concurrently, and each BE processes part of the original file.</p>
<p><em>Note: The configurations in both FEs are system configurations, that is to say, their modifications work on all Broker load tasks.</em></p>
</li>
<li><p class="first">Customize the timeout time of the current import task when creating the import</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Current</span> <span class="kn">import</span> <span class="nn">task</span> <span class="n">single</span> <span class="n">BE</span> <span class="n">processing</span> <span class="n">data</span> <span class="n">volume</span> <span class="o">/</span> <span class="n">user</span> <span class="n">Doris</span> <span class="n">cluster</span> <span class="n">slowest</span> <span class="kn">import</span> <span class="nn">speed</span> <span class="p">(</span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">current</span> <span class="kn">import</span> <span class="nn">task</span> <span class="n">timeout</span> <span class="n">time</span> <span class="o">&gt;=</span> <span class="n">current</span> <span class="kn">import</span> <span class="nn">task</span> <span class="n">single</span> <span class="n">BE</span> <span class="n">processing</span> <span class="n">data</span> <span class="n">volume</span> <span class="o">/</span> <span class="mi">10</span><span class="n">M</span><span class="o">/</span><span class="n">s</span>

<span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">a</span> <span class="mi">100</span><span class="n">G</span> <span class="n">file</span> <span class="k">with</span> <span class="mi">10</span> <span class="n">BEs</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">cluster</span>
<span class="n">Timeout</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="n">G</span> <span class="o">/</span> <span class="mi">10</span><span class="n">M</span> <span class="o">/</span><span class="n">s</span>
</pre></div>
</div>
</li>
<li><p class="first">When the user finds that the timeout time calculated in the second step exceeds the default maximum time-out time for importing the system by 4 hours.</p>
<p>At this time, it is not recommended that users directly increase the maximum time-out to solve the problem. If the single import time exceeds the default maximum import timeout of 4 hours, it is better to solve the problem by splitting the file to be imported and importing it several times. The main reason is that if a single import exceeds 4 hours, the time cost of retry after import failure is very high.</p>
<p>The maximum amount of imported file data expected by the Doris cluster can be calculated by the following formula:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Expected</span> <span class="n">maximum</span> <span class="n">imported</span> <span class="n">file</span> <span class="n">data</span> <span class="o">=</span> <span class="mi">14400</span><span class="n">s</span> <span class="o">*</span> <span class="mi">10</span><span class="n">M</span> <span class="o">/</span> <span class="n">s</span> <span class="o">*</span> <span class="n">BE</span> <span class="n">number</span>
<span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">the</span> <span class="n">BE</span> <span class="n">number</span> <span class="n">of</span> <span class="n">clusters</span> <span class="ow">is</span> <span class="mf">10.</span>
<span class="n">Expected</span> <span class="n">maximum</span> <span class="n">imported</span> <span class="n">file</span> <span class="n">data</span> <span class="n">volume</span> <span class="o">=</span> <span class="mi">14400</span> <span class="o">*</span> <span class="mi">10</span><span class="n">M</span> <span class="o">/</span> <span class="n">s</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">=</span> <span class="mi">1440000</span><span class="n">M</span> <span class="mi">1440</span><span class="n">G</span>

<span class="n">Note</span><span class="p">:</span> <span class="n">The</span> <span class="n">average</span> <span class="n">user</span><span class="s1">&#39;s environment may not reach the speed of 10M/s, so it is recommended that more than 500G files be split and imported.</span>
</pre></div>
</div>
</li>
</ol>
</li>
</ul>
</div>
<div class="section" id="complete-examples">
<h3>Complete examples<a class="headerlink" href="#complete-examples" title="Permalink to this headline">¶</a></h3>
<p>Data situation: User data in HDFS, file address is hdfs://abc.com:8888/store_sales, HDFS authentication user name is root, password is password, data size is about 30G, hope to import into database bj_sales table store_sales.</p>
<p>Cluster situation: The number of BEs in the cluster is about 3, and the Broker name is broker.</p>
<ul>
<li><p class="first">Step 1: After the calculation of the above method, the single BE import quantity is 10G, then the configuration of FE needs to be modified first, and the maximum amount of single BE import is changed to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_bytes_per_broker_scanner</span> <span class="o">=</span> <span class="mi">10737418240</span>
</pre></div>
</div>
</li>
<li><p class="first">Step 2: Calculated, the import time is about 1000s, which does not exceed the default timeout time. No custom timeout time for import can be configured.</p>
</li>
<li><p class="first">Step 3: Create import statements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LOAD</span> <span class="n">LABEL</span> <span class="n">bj_sales</span><span class="o">.</span><span class="n">store_sales_broker_load_01</span>
<span class="p">(</span>
    <span class="n">DATA</span> <span class="n">INFILE</span><span class="p">(</span><span class="s2">&quot;hdfs://abc.com:8888/store_sales&quot;</span><span class="p">)</span>
    <span class="n">INTO</span> <span class="n">TABLE</span> <span class="n">store_sales</span>
<span class="p">)</span>
<span class="n">WITH</span> <span class="n">BROKER</span> <span class="s1">&#39;broker&#39;</span>
<span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="common-questions">
<h2>Common Questions<a class="headerlink" href="#common-questions" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">failed with : <code class="docutils literal notranslate"><span class="pre">Scan</span> <span class="pre">bytes</span> <span class="pre">per</span> <span class="pre">broker</span> <span class="pre">scanner</span> <span class="pre">exceed</span> <span class="pre">limit:xxx</span></code></p>
<p>Refer to the Best Practices section of the document to modify the FE configuration items <code class="docutils literal notranslate"><span class="pre">max_bytes_per_broker_scanner</span></code> and <code class="docutils literal notranslate"><span class="pre">max_broker_concurrency'.</span></code></p>
</li>
<li><p class="first">failed with ：<code class="docutils literal notranslate"><span class="pre">failed</span> <span class="pre">to</span> <span class="pre">send</span> <span class="pre">batch</span></code> or <code class="docutils literal notranslate"><span class="pre">TabletWriter</span> <span class="pre">add</span> <span class="pre">batch</span> <span class="pre">with</span> <span class="pre">unknown</span> <span class="pre">id</span></code></p>
<p>Refer to <strong>General System Configuration</strong> in <strong>BE Configuration</strong> in the Import Manual (./load-manual.md), and modify <code class="docutils literal notranslate"><span class="pre">query_timeout</span></code> and <code class="docutils literal notranslate"><span class="pre">streaming_load_rpc_max_alive_time_sec</span></code> appropriately.</p>
</li>
<li><p class="first">failed with : <code class="docutils literal notranslate"><span class="pre">LOAD_RUN_FAIL;</span> <span class="pre">msg:</span> <span class="pre">Invalid</span> <span class="pre">Column</span> <span class="pre">Name:</span> <span class="pre">xxx</span></code>
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp; If it is PARQUET or ORC format data, you need to keep the column names in the file header consistent with the column names in the doris table, such as:
&nbsp;&nbsp;&nbsp;&nbsp; <code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="pre">(tmp_c1,</span> <span class="pre">tmp_c2)</span> <span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="pre">SET</span> <span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="pre">(</span> <span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="pre">id</span> <span class="pre">=</span> <span class="pre">tmp_c2,</span> <span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="pre">name</span> <span class="pre">=</span> <span class="pre">tmp_c1</span> <span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;</span> <span class="pre">)</span> <span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;</span></code> `
&nbsp;&nbsp;&nbsp;&nbsp; Represents getting the column with (tmp_c1, tmp_c2) as the column name in parquet or orc, which is mapped to the (id, name) column in the doris table. If set is not set, the column names in the column are used as the mapping relationship.</p>
</li>
</ul>
<p>Note: If the orc file directly generated by some hive versions is used, the table header in the orc file is not the column name in the hive meta, but (_col0, _col1, _col2, …), which may cause the Invalid Column Name error, then You need to use set for mapping.</p>
</div>
</div>


           </div>
           
          </div>
          <!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="stream-load-manual_EN.html" class="btn btn-neutral float-right" title="Stream load" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="load-manual_EN.html" class="btn btn-neutral float-left" title="Introduction Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>