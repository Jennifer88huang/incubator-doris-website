

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Routine Load &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Insert Into" href="insert-into-manual_EN.html" />
    <link rel="prev" title="Stream load" href="stream-load-manual_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installing/index.html">Compilation and deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/index.html">Getting started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Administrator Guide</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Load Data</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="load-manual_EN.html">Introduction Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="broker-load-manual_EN.html">Broker Load</a></li>
<li class="toctree-l4"><a class="reference internal" href="stream-load-manual_EN.html">Stream load</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Routine Load</a></li>
<li class="toctree-l4"><a class="reference internal" href="insert-into-manual_EN.html">Insert Into</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../http-actions/index.html">HTTP API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operation/index.html">Maintainence Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../backup-restore_EN.html">Backup and Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../colocation-join_EN.html">Colocation Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../export_manual_EN.html">Data export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../privilege_EN.html">Authority Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../small-file-mgr_EN.html">File Manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal/index.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql-reference/index.html">SQL Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">English</a> &raquo;</li>
        
          <li><a href="../index.html">Administrator Guide</a> &raquo;</li>
        
          <li><a href="index.html">Load Data</a> &raquo;</li>
        
      <li>Routine Load</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/administrator-guide/load-data/routine-load-manual_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="routine-load">
<h1>Routine Load<a class="headerlink" href="#routine-load" title="Permalink to this headline">¶</a></h1>
<p>Routine Load provides users with a function to automatically import data from a specified data source.</p>
<p>This document mainly introduces the realization principle, usage and best practices of this function.</p>
<div class="section" id="noun-interpretation">
<h2>Noun Interpretation<a class="headerlink" href="#noun-interpretation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>FE: Frontend, the front-end node of Doris. Responsible for metadata management and request access.</li>
<li>BE: Backend, Doris’s back-end node. Responsible for query execution and data storage.</li>
<li>Routine LoadJob: A routine import job submitted by the user.</li>
<li>Job Scheduler: Import job scheduler routinely for scheduling and splitting a Routine LoadJob into multiple Tasks.</li>
<li>Task：RoutineLoadJob 被 JobScheduler 根据规则拆分的子任务。</li>
<li>Task Scheduler: Task Scheduler. It is used to schedule the execution of Task.</li>
</ul>
</div>
<div class="section" id="principle">
<h2>Principle<a class="headerlink" href="#principle" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>         <span class="o">+---------+</span>
         <span class="o">|</span>  <span class="n">Client</span> <span class="o">|</span>
         <span class="o">+----+----+</span>
              <span class="o">|</span>
<span class="o">+-----------------------------+</span>
<span class="o">|</span> <span class="n">FE</span>          <span class="o">|</span>               <span class="o">|</span>
<span class="o">|</span> <span class="o">+-----------</span><span class="n">v</span><span class="o">------------+</span>  <span class="o">|</span>
<span class="o">|</span> <span class="o">|</span>                        <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span> <span class="o">|</span>   <span class="n">Routine</span> <span class="n">Load</span> <span class="n">Job</span>     <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span> <span class="o">|</span>                        <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span> <span class="o">+---+--------+--------+--+</span>  <span class="o">|</span>
<span class="o">|</span>     <span class="o">|</span>        <span class="o">|</span>        <span class="o">|</span>     <span class="o">|</span>
<span class="o">|</span> <span class="o">+---</span><span class="n">v</span><span class="o">--+</span> <span class="o">+---</span><span class="n">v</span><span class="o">--+</span> <span class="o">+---</span><span class="n">v</span><span class="o">--+</span>  <span class="o">|</span>
<span class="o">|</span> <span class="o">|</span> <span class="n">task</span> <span class="o">|</span> <span class="o">|</span> <span class="n">task</span> <span class="o">|</span> <span class="o">|</span> <span class="n">task</span> <span class="o">|</span>  <span class="o">|</span>
<span class="o">|</span> <span class="o">+--+---+</span> <span class="o">+---+--+</span> <span class="o">+---+--+</span>  <span class="o">|</span>
<span class="o">|</span>    <span class="o">|</span>         <span class="o">|</span>        <span class="o">|</span>     <span class="o">|</span>
<span class="o">+-----------------------------+</span>
     <span class="o">|</span>         <span class="o">|</span>        <span class="o">|</span>
     <span class="n">v</span>         <span class="n">v</span>        <span class="n">v</span>
 <span class="o">+---+--+</span>   <span class="o">+--+---+</span>   <span class="o">++-----+</span>
 <span class="o">|</span>  <span class="n">BE</span>  <span class="o">|</span>   <span class="o">|</span>  <span class="n">BE</span>  <span class="o">|</span>   <span class="o">|</span>  <span class="n">BE</span>  <span class="o">|</span>
 <span class="o">+------+</span>   <span class="o">+------+</span>   <span class="o">+------+</span>
</pre></div>
</div>
<p>As shown above, Client submits a routine import job to FE.</p>
<p>FE splits an import job into several Tasks through Job Scheduler. Each Task is responsible for importing a specified portion of the data. Task is assigned by Task Scheduler to execute on the specified BE.</p>
<p>On BE, a Task is considered a common import task, which is imported through the import mechanism of Stream Load. After importing, report to FE.</p>
<p>Job Scheduler in FE continues to generate subsequent new Tasks based on the results reported, or retries failed Tasks.</p>
<p>The whole routine import job completes the data uninterrupted import by continuously generating new Tasks.</p>
</div>
<div class="section" id="kafka-routine-load">
<h2>Kafka routine load<a class="headerlink" href="#kafka-routine-load" title="Permalink to this headline">¶</a></h2>
<p>Currently we only support routine imports from Kafka systems. This section details Kafka’s routine introduction usage and best practices.</p>
<div class="section" id="use-restrictions">
<h3>Use restrictions<a class="headerlink" href="#use-restrictions" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li>Supporting unauthenticated Kafka access and the Kafka cluster authenticated by SSL.</li>
<li>The supported message format is CSV text format. Each message is a line, and line end <strong>does not contain</strong> newline characters.</li>
<li>Only Kafka version 0.10.0.0 (including) is supported.</li>
</ol>
</div>
<div class="section" id="create-routine-import-tasks">
<h3>Create routine import tasks<a class="headerlink" href="#create-routine-import-tasks" title="Permalink to this headline">¶</a></h3>
<p>After creating a detailed grammar for routine import tasks, you can connect to Doris and execute <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">CREATE</span> <span class="pre">ROUTINE</span> <span class="pre">LOAD';</span> </code>Check grammar help. Here is a detailed description of the creation of the job note.</p>
<ul>
<li><p class="first">columns_mapping</p>
<p><code class="docutils literal notranslate"><span class="pre">colum_mapping</span></code> is mainly used to specify table structure and column mapping relationships in message, as well as transformation of some columns. If not specified, Doris defaults that columns in message and columns in table structure correspond one by one in order. Although under normal circumstances, if the source data is exactly one-to-one correspondence, it is not specified that normal data import can also be carried out. However, we strongly recommend that users <strong>explicitly specify column mapping relationships</strong>. In this way, when the table structure changes (such as adding a nullable column) or the source file changes (such as adding a column), the import task can continue. Otherwise, when the above changes occur, the import will report an error because the column mapping relationship no longer corresponds one to one.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">columns_mapping</span></code>, we can also use some built-in functions to convert columns. But you need to pay attention to the actual column types corresponding to the function parameters. Examples are given to illustrate:</p>
<p>Assume that the user needs to import a table containing only <code class="docutils literal notranslate"><span class="pre">k1</span></code> columns of <code class="docutils literal notranslate"><span class="pre">int</span></code> type. And the null value in the source file needs to be converted to 0. This function can be implemented through the <code class="docutils literal notranslate"><span class="pre">ifnull</span></code> function. The correct way to use it is as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">COLUMNS</span> <span class="pre">(xx,</span> <span class="pre">k1=ifnull(xx,</span> <span class="pre">&quot;3&quot;))</span></code></p>
<p>Note that we use <code class="docutils literal notranslate"><span class="pre">3</span></code> instead of <code class="docutils literal notranslate"><span class="pre">3</span></code>, although the type of <code class="docutils literal notranslate"><span class="pre">k1</span></code> is <code class="docutils literal notranslate"><span class="pre">int</span></code>. Because the column types in the source data are <code class="docutils literal notranslate"><span class="pre">varchar</span></code> for the import task, the <code class="docutils literal notranslate"><span class="pre">xx</span></code> virtual column types here are also <code class="docutils literal notranslate"><span class="pre">varchar</span></code>. So we need to use <code class="docutils literal notranslate"><span class="pre">3</span></code> for matching, otherwise <code class="docutils literal notranslate"><span class="pre">ifnull</span></code> function can not find the function signature with parameter <code class="docutils literal notranslate"><span class="pre">(varchar,</span> <span class="pre">int)</span></code>, and there will be an error.</p>
<p>Another example is to assume that the user needs to import a table containing only <code class="docutils literal notranslate"><span class="pre">k1</span></code> columns of <code class="docutils literal notranslate"><span class="pre">int</span></code> type. And the corresponding columns in the source file need to be processed: the negative number is converted to positive, and the positive number is multiplied by 100. This function can be implemented by the <code class="docutils literal notranslate"><span class="pre">case</span> <span class="pre">when</span></code> function, which should be correctly written as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">COLUMNS</span> <span class="pre">(xx,</span> <span class="pre">case</span> <span class="pre">when</span> <span class="pre">xx</span> <span class="pre">&lt;</span> <span class="pre">0</span> <span class="pre">than</span> <span class="pre">cast(-xx</span> <span class="pre">as</span> <span class="pre">varchar)</span> <span class="pre">else</span> <span class="pre">cast((xx</span> <span class="pre">+</span> <span class="pre">'100')</span> <span class="pre">as</span> <span class="pre">varchar)</span> <span class="pre">end)</span></code></p>
<p>Note that we need to convert all the parameters in `case when’to varchar in order to get the desired results.</p>
</li>
<li><p class="first">where_predicates</p>
<p>The column type in <code class="docutils literal notranslate"><span class="pre">where_predicates</span></code> is already the actual column type, so there is no need to force the conversion to varchar type as `columns_mapping’. Write according to the actual column type.</p>
</li>
<li><p class="first">desired_concurrent_number</p>
<p><code class="docutils literal notranslate"><span class="pre">desired_concurrent_number</span></code> is used to specify the expected concurrency of a routine job. That is, how many tasks are executed simultaneously for a job at most. For Kafka import, the current actual concurrency calculation is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Min</span><span class="p">(</span><span class="n">partition</span> <span class="n">num</span><span class="p">,</span> <span class="n">desired_concurrent_number</span><span class="p">,</span> <span class="n">alive_backend_num</span><span class="p">,</span> <span class="n">Config</span><span class="o">.</span><span class="n">max_routine_load_task_concurrrent_num</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">Config.max_routine_load_task_concurrent_num</span></code> is a default maximum concurrency limit for the system. This is a FE configuration, which can be adjusted by reconfiguration. The default is 5.</p>
<p>The partition num refers to the number of partitions subscribed to Kafka topic. <code class="docutils literal notranslate"> <span class="pre">alive_backend_num</span></code> is the current normal number of BE nodes.</p>
</li>
<li><p class="first">max_batch_interval/max_batch_rows/max_batch_size</p>
<p>These three parameters are used to control the execution time of a single task. If any of these thresholds is reached, the task ends. Where <code class="docutils literal notranslate"><span class="pre">max_batch_rows</span></code> is used to record the number of data rows read from Kafka. <code class="docutils literal notranslate"> <span class="pre">Max_batch_size</span></code> is used to record the amount of data read from Kafka in bytes. At present, the consumption rate of a task is about 5-10MB/s.</p>
<p>Assuming a row of data is 500B, the user wants a task every 100MB or 10 seconds. The expected processing time of 100MB is 10-20 seconds, and the corresponding number of rows is about 200,000 rows. A reasonable configuration is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;max_batch_interval&quot;</span> <span class="o">=</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
<span class="s2">&quot;max_batch_rows&quot;</span> <span class="o">=</span> <span class="s2">&quot;200000&quot;</span><span class="p">,</span>
<span class="s2">&quot;max_batch_size&quot;</span> <span class="o">=</span> <span class="s2">&quot;104857600&quot;</span>
</pre></div>
</div>
<p>The parameters in the examples above are also default parameters for these configurations.</p>
</li>
<li><p class="first">max_error_number</p>
<p><code class="docutils literal notranslate"> <span class="pre">max_error_number</span></code> is used to control the error rate. When the error rate is too high, the job will be automatically suspended. Because the whole job is oriented to data flow, and because of the boundless nature of data flow, we can not calculate the error rate through an error ratio like other import tasks. Therefore, a new computing method is provided to calculate the error ratio in the data stream.</p>
<p>We set up a sampling window. The size of the window is <code class="docutils literal notranslate"><span class="pre">max_batch_rows</span> <span class="pre">*</span> <span class="pre">10</span></code>. In a sampling window, if the number of error lines exceeds <code class="docutils literal notranslate"><span class="pre">max_error_number</span></code>, the job is suspended. If it does not exceed, the next window starts to recalculate the number of erroneous rows.</p>
<p>Let’s assume <code class="docutils literal notranslate"><span class="pre">max_batch_rows</span></code> is 200,000, and the window size is 2,000,000. Let <code class="docutils literal notranslate"><span class="pre">max_error_number</span></code> be 20,000, that is, 20,000 erroneous actions per 2,000,000 lines expected by the user. That is, the error rate is 1%. But because not every batch of tasks consumes 200,000 rows, the actual range of windows is [2000000, 2200000], that is, 10% statistical error.</p>
<p>Error rows do not include rows filtered through where conditions. But it includes rows that do not have partitions in the corresponding Doris table.</p>
</li>
<li><p class="first">data_source_properties</p>
<p><code class="docutils literal notranslate"> <span class="pre">Data_source_properties</span></code> can specify consumption specific Kakfa partition. If not specified, all partitions of the topic subscribed are consumed by default.</p>
<p>Note that when partition is explicitly specified, the import job will no longer dynamically detect changes in Kafka partition. If not specified, the consumption partition will be dynamically adjusted according to the change of Kafka partition.</p>
</li>
</ul>
<div class="section" id="accessing-the-kafka-cluster-of-ssl-authentication">
<h4>Accessing the Kafka Cluster of SSL Authentication<a class="headerlink" href="#accessing-the-kafka-cluster-of-ssl-authentication" title="Permalink to this headline">¶</a></h4>
<p>Accessing the Kafka cluster for SSL authentication requires the user to provide a certificate file (ca.pem) to authenticate the Kafka Broker public key. If the Kafka cluster opens client authentication at the same time, the client’s public key (client. pem), key file (client. key), and key password are also required. The required files need to be uploaded to Doris by the <code class="docutils literal notranslate"><span class="pre">CREAE</span> <span class="pre">FILE</span></code> command,** and the catalog name is <code class="docutils literal notranslate"><span class="pre">kafka</span></code>**. The specific help of the <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">FILE</span></code> command can be found in `HELP CREATE FILE;’. An example is given here:</p>
<ol>
<li><p class="first">Upload files</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">FILE</span> <span class="s2">&quot;ca.pem&quot;</span> <span class="n">PROPERTIES</span><span class="p">(</span><span class="s2">&quot;url&quot;</span> <span class="o">=</span> <span class="s2">&quot;https://example_url/kafka-key/ca.pem&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span> <span class="o">=</span> <span class="s2">&quot;kafka&quot;</span><span class="p">);</span>
<span class="n">CREATE</span> <span class="n">FILE</span> <span class="s2">&quot;client.key&quot;</span> <span class="n">PROPERTIES</span><span class="p">(</span><span class="s2">&quot;url&quot;</span> <span class="o">=</span> <span class="s2">&quot;https://example_urlkafka-key/client.key&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span> <span class="o">=</span> <span class="s2">&quot;kafka&quot;</span><span class="p">);</span>
<span class="n">CREATE</span> <span class="n">FILE</span> <span class="s2">&quot;client.pem&quot;</span> <span class="n">PROPERTIES</span><span class="p">(</span><span class="s2">&quot;url&quot;</span> <span class="o">=</span> <span class="s2">&quot;https://example_url/kafka-key/client.pem&quot;</span><span class="p">,</span> <span class="s2">&quot;catalog&quot;</span> <span class="o">=</span> <span class="s2">&quot;kafka&quot;</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">Create routine import jobs</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">ROUTINE</span> <span class="n">LOAD</span> <span class="n">db1</span><span class="o">.</span><span class="n">job1</span> <span class="n">on</span> <span class="n">tbl1</span>
<span class="n">PROPERTIES</span>
<span class="p">(</span>
    <span class="s2">&quot;desired_concurrent_number&quot;</span><span class="o">=</span><span class="s2">&quot;1&quot;</span>
<span class="p">)</span>
<span class="n">FROM</span> <span class="n">KAFKA</span>
<span class="p">(</span>
    <span class="s2">&quot;kafka_broker_list&quot;</span><span class="o">=</span> <span class="s2">&quot;broker1:9091,broker2:9091&quot;</span><span class="p">,</span>
    <span class="s2">&quot;kafka_topic&quot;</span> <span class="o">=</span> <span class="s2">&quot;my_topic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property.security.protocol&quot;</span> <span class="o">=</span> <span class="s2">&quot;ssl&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property.ssl.ca.location&quot;</span> <span class="o">=</span> <span class="s2">&quot;FILE:ca.pem&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property.ssl.certificate.location&quot;</span> <span class="o">=</span> <span class="s2">&quot;FILE:client.pem&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property.ssl.key.location&quot;</span> <span class="o">=</span> <span class="s2">&quot;FILE:client.key&quot;</span><span class="p">,</span>
    <span class="s2">&quot;property.ssl.key.password&quot;</span> <span class="o">=</span> <span class="s2">&quot;abcdefg&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>Doris accesses the Kafka cluster through Kafka’s C++ API <code class="docutils literal notranslate"><span class="pre">librdkafka</span></code>. The parameters supported by <code class="docutils literal notranslate"><span class="pre">librdkafka</span></code> can be consulted</p>
<p><code class="docutils literal notranslate"><span class="pre">https://github.com</span> <span class="pre">/edenhill</span> <span class="pre">/librdkafka</span> <span class="pre">/blob</span> <span class="pre">/master</span> <span class="pre">/CONFIGURATION.md</span> </code></p>
</div></blockquote>
</div>
</div>
<div class="section" id="view-the-status-of-import-jobs">
<h3>View the status of import jobs<a class="headerlink" href="#view-the-status-of-import-jobs" title="Permalink to this headline">¶</a></h3>
<p>Specific commands and examples for viewing the status of ** job ** can be viewed through <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">SHOW</span> <span class="pre">ROUTINE</span> <span class="pre">LOAD;</span></code>commands.</p>
<p>Specific commands and examples for viewing the running status of ** tasks ** can be viewed through <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">SHOW</span> <span class="pre">ROUTINE</span> <span class="pre">LOAD</span> <span class="pre">TASK;</span></code>commands.</p>
<p>You can only view tasks that are currently running. Tasks that have ended or not started cannot be viewed.</p>
</div>
<div class="section" id="job-control">
<h3>Job Control<a class="headerlink" href="#job-control" title="Permalink to this headline">¶</a></h3>
<p>用户可以通过 <code class="docutils literal notranslate"><span class="pre">STOP/PAUSE/RESUME</span></code> 三个命令来控制作业的停止，暂停和重启。可以通过 <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">STOP</span> <span class="pre">ROUTINE</span> <span class="pre">LOAD;</span></code>, <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">PAUSE</span> <span class="pre">ROUTINE</span> <span class="pre">LOAD;</span></code> 以及 <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">RESUME</span> <span class="pre">ROUTINE</span> <span class="pre">LOAD;</span></code> 三个命令查看帮助和示例。</p>
</div>
</div>
<div class="section" id="other-notes">
<h2>Other notes<a class="headerlink" href="#other-notes" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p class="first">The relationship between routine import operations and ALTER TABLE operations</p>
<ul class="simple">
<li>Routine imports do not block SCHEMA CHANGE and ROLLUP operations. But note that if SCHEMA CHANGE is completed, the column mapping relationship does not match, which will lead to a sharp increase in error data for jobs and eventually to job pause. It is recommended that such problems be reduced by explicitly specifying column mapping relationships in routine import operations and by adding Nullable columns or columns with Default values.</li>
<li>Deleting the Partition of a table may cause the imported data to fail to find the corresponding Partition and the job to pause.</li>
</ul>
</li>
<li><p class="first">Relations between routine import jobs and other import jobs (LOAD, DELETE, INSERT)</p>
<ul class="simple">
<li>Routine imports do not conflict with other LOAD and INSERT operations.</li>
<li>When performing a DELETE operation, the corresponding table partition cannot have any import tasks being performed. Therefore, before performing the DELETE operation, it may be necessary to suspend the routine import operation and wait for the task that has been issued to complete before DELETE can be executed.</li>
</ul>
</li>
<li><p class="first">The relationship between routine import jobs and DROP DATABASE/TABLE operations</p>
<p>When the corresponding database or table is deleted from the routine import, the job will automatically CANCEL.</p>
</li>
<li><p class="first">The relationship between Kafka type routine import and Kafka topic</p>
<p>When the `kafka_topic’of the user creating the routine import declaration does not exist in the Kafka cluster.</p>
<ul class="simple">
<li>If the broker of user Kafka cluster sets <code class="docutils literal notranslate"><span class="pre">auto.create.topics.enable</span> <span class="pre">=</span> <span class="pre">true</span></code>, then <code class="docutils literal notranslate"><span class="pre">kafka_topic</span></code> will be created automatically first. The number of partitions created automatically is determined by the broker configuration <code class="docutils literal notranslate"><span class="pre">num.partitions</span></code> in <strong>user’s Kafka cluster</strong>. Routine jobs will read the topic data regularly and continuously.</li>
<li>If the broker of the user Kafka cluster sets <code class="docutils literal notranslate"><span class="pre">auto.create.topics.enable</span> <span class="pre">=</span> <span class="pre">false</span></code>, topic will not be created automatically, and routine jobs will be suspended before any data is read, in the state of <code class="docutils literal notranslate"><span class="pre">PAUSED</span></code>.</li>
</ul>
<p>So, if users want to be created automatically by routine jobs when Kafka topic does not exist, they just need to set <code class="docutils literal notranslate"><span class="pre">auto.create.topics.enable</span> <span class="pre">=</span> <span class="pre">true</span></code> to the broker in <strong>user’s Kafka cluster</strong>.</p>
</li>
</ol>
</div>
<div class="section" id="relevant-parameters">
<h2>Relevant parameters<a class="headerlink" href="#relevant-parameters" title="Permalink to this headline">¶</a></h2>
<p>Some system configuration parameters affect the use of routine imports.</p>
<ol>
<li><p class="first">max_routine_load_task_concurrent_num</p>
<p>FE configuration item, default 5, can be modified at run time. This parameter limits the maximum number of subtasks concurrently imported routinely. It is recommended that the default values be maintained. Setting too large may lead to too many concurrent tasks and occupy cluster resources.</p>
</li>
<li><p class="first">max_consumer_num_per_group</p>
<p>BE configuration item, default 3. This parameter represents the maximum number of consumers generated in a sub-task for data consumption. For Kafka data sources, a consumer may consume one or more Kafka partitions. Assuming that a task needs to consume six Kafka partitions, three consumers will be generated, and each consumer consumes two partitions. If there are only two partitions, only two consumers will be generated, and each consumer consumes one partition.</p>
</li>
<li><p class="first">push_write_mbytes_per_sec</p>
<p>BE configuration item. The default is 10, or 10MB/s. This parameter is a general import parameter and is not limited to routine import operations. This parameter limits the speed at which imported data is written to disk. For high performance storage devices such as SSD, this speed limit can be increased appropriately.</p>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="insert-into-manual_EN.html" class="btn btn-neutral float-right" title="Insert Into" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="stream-load-manual_EN.html" class="btn btn-neutral float-left" title="Stream load" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the name of Apache TLP sponsor. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>