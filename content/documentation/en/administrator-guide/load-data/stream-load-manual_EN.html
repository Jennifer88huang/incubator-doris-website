

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Stream load &mdash; Doris Documentations 0.11.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Routine Load" href="routine-load-manual_EN.html" />
    <link rel="prev" title="Broker Load" href="broker-load-manual_EN.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Doris Documentations
          

          
          </a>

          
            
            
              <div class="version">
                0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../cn/index.html">中文</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">English</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../installing/index.html">Compilation and deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/index.html">Getting started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Administrator Guide</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Load Data</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="load-manual_EN.html">Introduction Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="broker-load-manual_EN.html">Broker Load</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Stream load</a></li>
<li class="toctree-l4"><a class="reference internal" href="routine-load-manual_EN.html">Routine Load</a></li>
<li class="toctree-l4"><a class="reference internal" href="insert-into-manual_EN.html">Insert Into</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../http-actions/index.html">HTTP API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operation/index.html">Maintainence Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/index.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../backup-restore_EN.html">Backup and Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../colocation-join_EN.html">Colocation Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="../export_manual_EN.html">Data export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../privilege_EN.html">Authority Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../session-variables_EN.html">Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../small-file-mgr_EN.html">File Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql-mode_EN.html">SQL MODE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../time-zone_EN.html">Time zone</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extending-doris/index.html">Extending Ability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internal/index.html">Design Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sql-reference/index.html">SQL Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer-guide/index.html">Developer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/index.html">Apache Commnity</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Doris Documentations</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">English</a> &raquo;</li>
        
          <li><a href="../index.html">Administrator Guide</a> &raquo;</li>
        
          <li><a href="index.html">Load Data</a> &raquo;</li>
        
      <li>Stream load</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/incubator-doris/blob/master/docs/documentation/en/administrator-guide/load-data/stream-load-manual_EN.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
--><div class="section" id="stream-load">
<h1>Stream load<a class="headerlink" href="#stream-load" title="Permalink to this headline">¶</a></h1>
<p>Stream load is a synchronous way of importing. Users import local files or data streams into Doris by sending HTTP protocol requests. Stream load synchronously executes the import and returns the import result. Users can directly determine whether the import is successful by the return body of the request.</p>
<p>Stream load is mainly suitable for importing local files or data from data streams through procedures.</p>
<div class="section" id="basic-principles">
<h2>Basic Principles<a class="headerlink" href="#basic-principles" title="Permalink to this headline">¶</a></h2>
<p>The following figure shows the main flow of Stream load, omitting some import details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                         <span class="o">^</span>      <span class="o">+</span>
                         <span class="o">|</span>      <span class="o">|</span>
                         <span class="o">|</span>      <span class="o">|</span> <span class="mi">1</span><span class="n">A</span><span class="o">.</span> <span class="n">User</span> <span class="n">submit</span> <span class="n">load</span> <span class="n">to</span> <span class="n">FE</span>
                         <span class="o">|</span>      <span class="o">|</span>
                         <span class="o">|</span>   <span class="o">+--</span><span class="n">v</span><span class="o">-----------+</span>
                         <span class="o">|</span>   <span class="o">|</span> <span class="n">FE</span>           <span class="o">|</span>
<span class="mf">5.</span> <span class="n">Return</span> <span class="n">result</span> <span class="n">to</span> <span class="n">user</span> <span class="o">|</span>   <span class="o">+--+-----------+</span>
                         <span class="o">|</span>      <span class="o">|</span>
                         <span class="o">|</span>      <span class="o">|</span> <span class="mf">2.</span> <span class="n">Redirect</span> <span class="n">to</span> <span class="n">BE</span>
                         <span class="o">|</span>      <span class="o">|</span>
                         <span class="o">|</span>   <span class="o">+--</span><span class="n">v</span><span class="o">-----------+</span>
                         <span class="o">+---+</span><span class="n">Coordinator</span> <span class="n">BE</span><span class="o">|</span> <span class="mi">1</span><span class="n">B</span><span class="o">.</span> <span class="n">User</span> <span class="n">submit</span> <span class="n">load</span> <span class="n">to</span> <span class="n">BE</span>
                             <span class="o">+-+-----+----+-+</span>
                               <span class="o">|</span>     <span class="o">|</span>    <span class="o">|</span>
                         <span class="o">+-----+</span>     <span class="o">|</span>    <span class="o">+-----+</span>
                         <span class="o">|</span>           <span class="o">|</span>          <span class="o">|</span> <span class="mf">3.</span> <span class="n">Distrbute</span> <span class="n">data</span>
                         <span class="o">|</span>           <span class="o">|</span>          <span class="o">|</span>
                       <span class="o">+-</span><span class="n">v</span><span class="o">-+</span>       <span class="o">+-</span><span class="n">v</span><span class="o">-+</span>      <span class="o">+-</span><span class="n">v</span><span class="o">-+</span>
                       <span class="o">|</span><span class="n">BE</span> <span class="o">|</span>       <span class="o">|</span><span class="n">BE</span> <span class="o">|</span>      <span class="o">|</span><span class="n">BE</span> <span class="o">|</span>
                       <span class="o">+---+</span>       <span class="o">+---+</span>      <span class="o">+---+</span>
</pre></div>
</div>
<p>In Stream load, Doris selects a node as the Coordinator node. This node is responsible for receiving data and distributing data to other data nodes.</p>
<p>Users submit import commands through HTTP protocol. If submitted to FE, FE forwards the request to a BE via the HTTP redirect instruction. Users can also submit import commands directly to a specified BE.</p>
<p>The final result of the import is returned to the user by Coordinator BE.</p>
</div>
<div class="section" id="basic-operations">
<h2>Basic operations<a class="headerlink" href="#basic-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-a-load">
<h3>Create a Load<a class="headerlink" href="#create-a-load" title="Permalink to this headline">¶</a></h3>
<p>Stream load submits and transfers data through HTTP protocol. Here, the <code class="docutils literal notranslate"><span class="pre">curl</span></code> command shows how to submit an import.</p>
<p>Users can also operate through other HTTP clients.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl --location-trusted -u user:passwd [-H &quot;&quot;...] -T data.file -XPUT http://fe_host:http_port/api/{db}/{table}/_stream_load

The following attributes are supported in Header:
label， column_separator， columns， where， max_filter_ratio， partitions
The format is: - H &quot;key1: value1&quot;
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">location</span><span class="o">-</span><span class="n">trusted</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">T</span> <span class="n">date</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;label:123&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">abc</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">8030</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">date</span><span class="o">/</span><span class="n">_stream_load</span>
</pre></div>
</div>
<p>The detailed syntax for creating imports helps to execute <code class="docutils literal notranslate"><span class="pre">HELP</span> <span class="pre">STREAM</span> <span class="pre">LOAD</span></code> view. The following section focuses on the significance of creating some parameters of Stream load.</p>
<div class="section" id="signature-parameters">
<h4>Signature parameters<a class="headerlink" href="#signature-parameters" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">user/passwd</p>
<p>Stream load uses the HTTP protocol to create the imported protocol and signs it through the Basic Access authentication. The Doris system verifies user identity and import permissions based on signatures.</p>
</li>
</ul>
</div>
<div class="section" id="import-task-parameters">
<h4>Import Task Parameters<a class="headerlink" href="#import-task-parameters" title="Permalink to this headline">¶</a></h4>
<p>Stream load uses HTTP protocol, so all parameters related to import tasks are set in the header. The significance of some parameters of the import task parameters of Stream load is mainly introduced below.</p>
<ul>
<li><p class="first">label</p>
<p>Identity of import task. Each import task has a unique label inside a single database. Label is a user-defined name in the import command. With this label, users can view the execution of the corresponding import task.</p>
<p>Another function of label is to prevent users from importing the same data repeatedly. <strong>It is strongly recommended that users use the same label for the same batch of data. This way, repeated requests for the same batch of data will only be accepted once, guaranteeing at-Most-Once</strong></p>
<p>When the corresponding import operation state of label is CANCELLED, the label can be used again.</p>
</li>
<li><p class="first">max_filter_ratio</p>
<p>The maximum tolerance rate of the import task is 0 by default, and the range of values is 0-1. When the import error rate exceeds this value, the import fails.</p>
<p>If the user wishes to ignore the wrong row, the import can be successful by setting this parameter greater than 0.</p>
<p>The calculation formula is as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">(dpp.abnorm.ALL</span> <span class="pre">/</span> <span class="pre">(dpp.abnorm.ALL</span> <span class="pre">+</span> <span class="pre">dpp.norm.ALL</span> <span class="pre">)</span> <span class="pre">)</span> <span class="pre">&gt;</span> <span class="pre">max_filter_ratio</span></code></p>
<p><code class="docutils literal notranslate"> <span class="pre">dpp.abnorm.ALL</span></code> denotes the number of rows whose data quality is not up to standard. Such as type mismatch, column mismatch, length mismatch and so on.</p>
<p><code class="docutils literal notranslate"><span class="pre">dpp.norm.ALL</span></code> refers to the number of correct data in the import process. The correct amount of data for the import task can be queried by the ``SHOW LOAD` command.</p>
</li>
</ul>
<p>The number of rows in the original file = <code class="docutils literal notranslate"><span class="pre">dpp.abnorm.ALL</span> <span class="pre">+</span> <span class="pre">dpp.norm.ALL</span></code></p>
<ul>
<li><p class="first">where</p>
<p>Import the filter conditions specified by the task. Stream load supports filtering of where statements specified for raw data. The filtered data will not be imported or participated in the calculation of filter ratio, but will be counted as <code class="docutils literal notranslate"><span class="pre">num_rows_unselected</span></code>.</p>
</li>
<li><p class="first">partition</p>
<p>Partition information for tables to be imported will not be imported if the data to be imported does not belong to the specified Partition. These data will be included in <code class="docutils literal notranslate"><span class="pre">dpp.abnorm.ALL</span></code>.</p>
</li>
<li><p class="first">columns</p>
<p>The function transformation configuration of data to be imported includes the sequence change of columns and the expression transformation, in which the expression transformation method is consistent with the query statement.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Examples</span> <span class="n">of</span> <span class="n">column</span> <span class="n">order</span> <span class="n">transformation</span><span class="p">:</span> <span class="n">There</span> <span class="n">are</span> <span class="n">two</span> <span class="n">columns</span> <span class="n">of</span> <span class="n">original</span> <span class="n">data</span><span class="p">,</span> <span class="ow">and</span> <span class="n">there</span> <span class="n">are</span> <span class="n">also</span> <span class="n">two</span> <span class="n">columns</span> <span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">table</span> <span class="n">at</span> <span class="n">present</span><span class="o">.</span> <span class="n">But</span> <span class="n">the</span> <span class="n">first</span> <span class="n">column</span> <span class="n">of</span> <span class="n">the</span> <span class="n">original</span> <span class="n">file</span> <span class="n">corresponds</span> <span class="n">to</span> <span class="n">the</span> <span class="n">C2</span> <span class="n">column</span> <span class="n">of</span> <span class="n">the</span> <span class="n">target</span> <span class="n">table</span><span class="p">,</span> <span class="k">while</span> <span class="n">the</span> <span class="n">second</span> <span class="n">column</span> <span class="n">of</span> <span class="n">the</span> <span class="n">original</span> <span class="n">file</span> <span class="n">corresponds</span> <span class="n">to</span> <span class="n">the</span> <span class="n">C1</span> <span class="n">column</span> <span class="n">of</span> <span class="n">the</span> <span class="n">target</span> <span class="n">table</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">written</span> <span class="k">as</span> <span class="n">follows</span><span class="p">:</span>
<span class="n">columns</span><span class="p">:</span> <span class="n">c2</span><span class="p">,</span><span class="n">c1</span>

<span class="n">Example</span> <span class="n">of</span> <span class="n">expression</span> <span class="n">transformation</span><span class="p">:</span> <span class="n">There</span> <span class="n">are</span> <span class="n">two</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">original</span> <span class="n">file</span> <span class="ow">and</span> <span class="n">two</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">target</span> <span class="n">table</span> <span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">)</span><span class="o">.</span> <span class="n">However</span><span class="p">,</span> <span class="n">both</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">original</span> <span class="n">file</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">transformed</span> <span class="n">by</span> <span class="n">functions</span> <span class="n">to</span> <span class="n">correspond</span> <span class="n">to</span> <span class="n">the</span> <span class="n">two</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">target</span> <span class="n">table</span><span class="o">.</span>
<span class="n">columns</span><span class="p">:</span> <span class="n">tmp_c1</span><span class="p">,</span> <span class="n">tmp_c2</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">year</span><span class="p">(</span><span class="n">tmp_c1</span><span class="p">),</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">mouth</span><span class="p">(</span><span class="n">tmp_c2</span><span class="p">)</span>
<span class="n">Tmp_</span><span class="o">*</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">placeholder</span><span class="p">,</span> <span class="n">representing</span> <span class="n">two</span> <span class="n">original</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">original</span> <span class="n">file</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">exec_mem_limit</p>
<p>Memory limit. Default is 2GB. Unit is Bytes</p>
</li>
</ul>
</div>
</div>
<div class="section" id="return-results">
<h3>Return results<a class="headerlink" href="#return-results" title="Permalink to this headline">¶</a></h3>
<p>Since Stream load is a synchronous import method, the result of the import is directly returned to the user by creating the return value of the import.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;TxnId&quot;</span><span class="p">:</span> <span class="mi">1003</span><span class="p">,</span>
    <span class="s2">&quot;Label&quot;</span><span class="p">:</span> <span class="s2">&quot;b6f3bc78-0d2c-45d9-9e4c-faa0a0149bee&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="s2">&quot;Success&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ExistingJobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span> <span class="o">//</span> <span class="n">optional</span>
    <span class="s2">&quot;Message&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NumberTotalRows&quot;</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">,</span>
    <span class="s2">&quot;NumberLoadedRows&quot;</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">,</span>
    <span class="s2">&quot;NumberFilteredRows&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;NumberUnselectedRows&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;LoadBytes&quot;</span><span class="p">:</span> <span class="mi">40888898</span><span class="p">,</span>
    <span class="s2">&quot;LoadTimeMs&quot;</span><span class="p">:</span> <span class="mi">2144</span><span class="p">,</span>
    <span class="s2">&quot;ErrorURL&quot;</span><span class="p">:</span> <span class="s2">&quot;http://192.168.1.1:8042/api/_load_error_log?file=__shard_0/error_log_insert_stmt_db18266d4d9b4ee5-abb00ddd64bdf005_db18266d4d9b4ee5_abb00ddd64bdf005&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following main explanations are given for the Stream load import result parameters:</p>
<ul>
<li><p class="first">TxnId: The imported transaction ID. Users do not perceive.</p>
</li>
<li><p class="first">Label: Import Label. User specified or automatically generated by the system.</p>
</li>
<li><p class="first">Status: Import completion status.</p>
<p>“Success”: Indicates successful import.</p>
<p>“Publish Timeout”: This state also indicates that the import has been completed, except that the data may be delayed and visible without retrying.</p>
<p>“Label Already Exists”：Label 重复，需更换 Label。</p>
<p>“Fail”: Import failed.</p>
</li>
<li><p class="first">ExistingJobStatus: The state of the load job corresponding to the existing Label.</p>
<p>This field is displayed only when the status is “Label Already Exists”. The user can know the status of the load job corresponding to Label through this state. “RUNNING” means that the job is still executing, and “FINISHED” means that the job is successful.</p>
</li>
<li><p class="first">Message: Import error messages.</p>
</li>
<li><p class="first">NumberTotalRows: Number of rows imported for total processing.</p>
</li>
<li><p class="first">NumberLoadedRows: Number of rows successfully imported.</p>
</li>
<li><p class="first">NumberFilteredRows: Number of rows that do not qualify for data quality.</p>
</li>
<li><p class="first">NumberUnselectedRows: Number of rows filtered by where condition.</p>
</li>
<li><p class="first">LoadBytes: Number of bytes imported.</p>
</li>
<li><p class="first">LoadTimeMs: Import completion time. Unit milliseconds.</p>
</li>
<li><p class="first">ErrorURL: If you have data quality problems, visit this URL to see specific error lines.</p>
</li>
</ul>
<blockquote>
<div>Note: Since Stream load is a synchronous import mode, import information will not be recorded in Doris system. Users cannot see Stream load asynchronously by looking at import commands. You need to listen for the return value of the create import request to get the import result.</div></blockquote>
</div>
<div class="section" id="cancel-load">
<h3>Cancel Load<a class="headerlink" href="#cancel-load" title="Permalink to this headline">¶</a></h3>
<p>Users can’t cancel Stream load manually. Stream load will be cancelled automatically by the system after a timeout or import error.</p>
</div>
</div>
<div class="section" id="relevant-system-configuration">
<h2>Relevant System Configuration<a class="headerlink" href="#relevant-system-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fe-configuration">
<h3>FE configuration<a class="headerlink" href="#fe-configuration" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">stream_load_default_timeout_second</p>
<p>The timeout time of the import task (in seconds) will be cancelled by the system if the import task is not completed within the set timeout time, and will become CANCELLED.</p>
<p>At present, Stream load does not support custom import timeout time. All Stream load import timeout time is uniform. The default timeout time is 300 seconds. If the imported source file can no longer complete the import within the specified time, the FE parameter <code class="docutils literal notranslate"><span class="pre">stream_load_default_timeout_second</span></code> needs to be adjusted.</p>
</li>
</ul>
</div>
<div class="section" id="be-configuration">
<h3>BE configuration<a class="headerlink" href="#be-configuration" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">streaming_load_max_mb</p>
<p>The maximum import size of Stream load is 10G by default, in MB. If the user’s original file exceeds this value, the BE parameter <code class="docutils literal notranslate"><span class="pre">streaming_load_max_mb</span></code> needs to be adjusted.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline">¶</a></h2>
<div class="section" id="application-scenarios">
<h3>Application scenarios<a class="headerlink" href="#application-scenarios" title="Permalink to this headline">¶</a></h3>
<p>The most appropriate scenario for using Stream load is that the original file is in memory or on disk. Secondly, since Stream load is a synchronous import method, users can also use this import if they want to obtain the import results in a synchronous manner.</p>
</div>
<div class="section" id="data-volume">
<h3>Data volume<a class="headerlink" href="#data-volume" title="Permalink to this headline">¶</a></h3>
<p>Since Stream load is based on the BE initiative to import and distribute data, the recommended amount of imported data is between 1G and 10G. Since the default maximum Stream load import data volume is 10G, the configuration of BE <code class="docutils literal notranslate"><span class="pre">streaming_load_max_mb</span></code> needs to be modified if files exceeding 10G are to be imported.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">file</span> <span class="n">to</span> <span class="n">be</span> <span class="n">imported</span> <span class="ow">is</span> <span class="mi">15</span><span class="n">G</span>
<span class="n">Modify</span> <span class="n">the</span> <span class="n">BE</span> <span class="n">configuration</span> <span class="n">streaming_load_max_mb</span> <span class="n">to</span> <span class="mi">16000</span>
</pre></div>
</div>
<p>Stream load default timeout is 300 seconds, according to Doris currently the largest import speed limit, about more than 3G files need to modify the import task default timeout.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Import</span> <span class="n">Task</span> <span class="n">Timeout</span> <span class="o">=</span> <span class="n">Import</span> <span class="n">Data</span> <span class="n">Volume</span> <span class="o">/</span> <span class="mi">10</span><span class="n">M</span> <span class="o">/</span> <span class="n">s</span> <span class="p">(</span><span class="n">Specific</span> <span class="n">Average</span> <span class="n">Import</span> <span class="n">Speed</span> <span class="n">Requires</span> <span class="n">Users</span> <span class="n">to</span> <span class="n">Calculate</span> <span class="n">Based</span> <span class="n">on</span> <span class="n">Their</span> <span class="n">Cluster</span> <span class="n">Conditions</span><span class="p">)</span>
<span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="kn">import</span> <span class="nn">a</span> <span class="mi">10</span><span class="n">G</span> <span class="n">file</span>
<span class="n">Timeout</span> <span class="o">=</span> <span class="mi">1000</span><span class="n">s</span> <span class="o">-</span><span class="mi">31561</span><span class="p">;</span><span class="o">.</span> <span class="mi">20110</span><span class="n">G</span> <span class="o">/</span> <span class="mi">10</span><span class="n">M</span> <span class="o">/</span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="section" id="complete-examples">
<h3>Complete examples<a class="headerlink" href="#complete-examples" title="Permalink to this headline">¶</a></h3>
<p>Data situation: In the local disk path / home / store_sales of the sending and importing requester, the imported data is about 15G, and it is hoped to be imported into the table store_sales of the database bj_sales.</p>
<p>Cluster situation: The concurrency of Stream load is not affected by cluster size.</p>
<ul>
<li><p class="first">Step 1: Does the import file size exceed the default maximum import size of 10G</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BE</span> <span class="n">conf</span>
<span class="n">streaming_load_max_mb</span> <span class="o">=</span> <span class="mi">16000</span>
</pre></div>
</div>
</li>
<li><p class="first">Step 2: Calculate whether the approximate import time exceeds the default timeout value</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Import</span> <span class="n">time</span> <span class="mi">15000</span><span class="o">/</span><span class="mi">10</span> <span class="o">=</span> <span class="mi">1500</span><span class="n">s</span>
<span class="n">Over</span> <span class="n">the</span> <span class="n">default</span> <span class="n">timeout</span> <span class="n">time</span><span class="p">,</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">modify</span> <span class="n">the</span> <span class="n">FE</span> <span class="n">configuration</span>
<span class="n">stream_load_default_timeout_second</span> <span class="o">=</span> <span class="mi">1500</span>
</pre></div>
</div>
</li>
<li><p class="first">Step 3: Create Import Tasks</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">--</span><span class="n">location</span><span class="o">-</span><span class="n">trusted</span> <span class="o">-</span><span class="n">u</span> <span class="n">user</span><span class="p">:</span><span class="n">password</span> <span class="o">-</span><span class="n">T</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">store_sales</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;label:abc&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">abc</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">8000</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">bj_sales</span><span class="o">/</span><span class="n">store_sales</span><span class="o">/</span><span class="n">_stream_load</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="common-questions">
<h2>Common Questions<a class="headerlink" href="#common-questions" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Label Already Exists</p>
<p>The Label repeat checking steps of Stream load are as follows:</p>
<ol>
<li><p class="first">Is there an import Label conflict that already exists with other import methods?</p>
<p>Because imported Label in Doris system does not distinguish between import methods, there is a problem that other import methods use the same Label.</p>
<p>Through <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">LOAD</span> <span class="pre">WHERE</span> <span class="pre">LABEL</span> <span class="pre">=</span> <span class="pre">&quot;xxx&quot;'</span></code>, where XXX is a duplicate Label string, see if there is already a Label imported by FINISHED that is the same as the Label created by the user.</p>
</li>
<li><p class="first">Are Stream loads submitted repeatedly for the same job?</p>
<p>Since Stream load is an HTTP protocol submission creation import task, HTTP Clients in various languages usually have their own request retry logic. After receiving the first request, the Doris system has started to operate Stream load, but because the result is not returned to the Client side in time, the Client side will retry to create the request. At this point, the Doris system is already operating on the first request, so the second request will be reported to Label Already Exists.</p>
<p>To sort out the possible methods mentioned above: Search FE Master’s log with Label to see if there are two <code class="docutils literal notranslate"><span class="pre">redirect</span> <span class="pre">load</span> <span class="pre">action</span> <span class="pre">to</span> <span class="pre">destination</span> <span class="pre">=</span> </code>redirect load action to destination’cases in the same Label. If so, the request is submitted repeatedly by the Client side.</p>
<p>It is suggested that the user calculate the approximate import time according to the data quantity of the current request, and change the request time-out time of the Client end according to the import time-out time, so as to avoid the request being submitted by the Client end many times.</p>
</li>
</ol>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="routine-load-manual_EN.html" class="btn btn-neutral float-right" title="Routine Load" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="broker-load-manual_EN.html" class="btn btn-neutral float-left" title="Broker Load" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Apache Doris(Incubating)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<div role="contentinfo">
    <p></p>
    <p>

        Apache Doris(incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.

    </p>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>